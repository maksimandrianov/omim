#include "testing/testing.hpp"

#include "generator/cities_boundaries_builder.hpp"
#include "generator/feature_builder.hpp"
#include "generator/generator_tests/common.hpp"
#include "generator/osm2type.hpp"
#include "generator/osm_element.hpp"
#include "generator/place_processor.hpp"

#include "indexer/classificator_loader.hpp"

#include "geometry/point2d.hpp"

#include <algorithm>
#include <cstdint>
#include <iterator>
#include <memory>
#include <set>
#include <utility>
#include <vector>

namespace
{
using namespace generator_tests;

class IdGenerator
{
public:
  friend IdGenerator & GetIdGen();

  void StopInc() { m_isInc = false; }
  void StartInc() { m_isInc = true; }
  uint64_t GetId()  { return m_isInc ? m_id++ : m_id; }

private:
  IdGenerator() = default;

  uint64_t m_id = 0;
  bool m_isInc = true;
};

IdGenerator & GetIdGen()
{
  static IdGenerator idGenerator;
  return idGenerator;
}

struct DisablerIdInc
{
  DisablerIdInc() { GetIdGen().StopInc(); }
  ~DisablerIdInc() { GetIdGen().StartInc(); }
};

feature::FeatureBuilder MakeFbForTest(Tags const & tags, OsmElement::EntityType t,
                                      std::vector<m2::PointD> const & points)
{
  auto element = MakeOsmElement(GetIdGen().GetId(), tags, t);
  feature::FeatureBuilder result;
  ftype::GetNameAndType(&element, result.GetParams());
  if (element.IsNode())
  {
    CHECK_EQUAL(points.size(), 1, ());
    result.SetOsmId(base::MakeOsmNode(element.m_id));
    result.SetCenter(points.front());
  }
  else if (element.IsRelation() || element.IsWay())
  {
    for (auto const & p : points)
      result.AddPoint(p);

    CHECK(result.IsGeometryClosed(), ());

    result.SetArea();

    result.SetOsmId(element.IsRelation() ? base::MakeOsmRelation(element.m_id)
                                         : base::MakeOsmWay(element.m_id));
  }
  return result;
}

bool TestTable(generator::OsmIdToBoundariesTable & table,
               std::set<std::pair<std::vector<base::GeoObjectId>, size_t>> const & answer)
{
  bool result = true;
  table.ForEachCluster([&](auto & ids, auto const & boundaries) {
    if (!result)
      return;

    std::sort(std::begin(ids), std::end(ids));
    if (!answer.count(std::make_pair(ids, boundaries.size())))
      result = false;
  });
  return result;
}

struct Loader
{
  Loader() { classificator::Load(); }
};

feature::FeatureBuilder MakeCArea()
{
  return MakeFbForTest({{"name", "City"}, {"place", "city"}}, OsmElement::EntityType::Relation,
                       {{172.54302978515625, -43.48331750944707},
                        {172.59796142578125, -43.572929222492384},
                        {172.67898559570312, -43.55302701392868},
                        {172.67967224121094, -43.48680489735276},
                        {172.62542724609375, -43.4509250075837},
                        {172.54302978515625, -43.48331750944707}});
}
}  // namespace

namespace generator_tests
{
class TestPlaceProcessor
{
public:
  TestPlaceProcessor() : kArea(MakeCArea()) {}

protected:
  Loader m_loader;
  feature::FeatureBuilder const kArea;
};
}  // namespace generator_tests

namespace
{
using namespace generator_tests;

UNIT_CLASS_TEST(TestPlaceProcessor, EmptyTest)
{
  generator::PlaceProcessor pp;
  TEST_EQUAL(pp.ProcessPlaces(), std::vector<feature::FeatureBuilder>(), ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, OnePlacePointTest)
{
  auto const point =
      MakeFbForTest({{"name", "City"}, {"place", "city"}}, OsmElement::EntityType::Node,
                    {{172.6314353942871, -43.493592271503786}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(point);

  std::vector<feature::FeatureBuilder> r{point};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {}), ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, OnePlaceAreaTest)
{
  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(kArea);

  std::vector<feature::FeatureBuilder> r{kArea};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {{{kArea.GetMostGenericOsmId()}, 1 /* cluster size */}}), ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, PointInAreaTest)
{
  auto const point =
      MakeFbForTest({{"name", "City"}, {"place", "city"}}, OsmElement::EntityType::Node,
                    {{172.6314353942871, -43.493592271503786}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(kArea);
  pp.Add(point);

  std::vector<feature::FeatureBuilder> r{point};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {{{point.GetMostGenericOsmId(), kArea.GetMostGenericOsmId()},
                           1 /* cluster size */}}),
       ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, SameNamesButDifferentPlacesTest)
{
  auto const point =
      MakeFbForTest({{"name", "City"}, {"place", "city"}}, OsmElement::EntityType::Node,
                    {{162.6314353942871, -33.493592271503786}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(kArea);
  pp.Add(point);

  std::vector<feature::FeatureBuilder> r{point, kArea};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {{{kArea.GetMostGenericOsmId()}, 1 /* cluster size */}}), ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, SelectBestPlaceTest)
{
  auto const point1 =
      MakeFbForTest({{"name", "City"}, {"place", "city"}}, OsmElement::EntityType::Node,
                    {{162.6314353942871, -33.493592271503786}});
  auto const point2 = MakeFbForTest({{"name", "City"}, {"place", "city"}, {"capital", "yes"}},
                                     OsmElement::EntityType::Node, {{162.63145, -33.4935}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(point1);
  pp.Add(point2);

  std::vector<feature::FeatureBuilder> r{point2};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {}), ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, MinskDuplicatingCityFeatureTest)
{
  DisablerIdInc _;
  auto const point = MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}},
                                    OsmElement::EntityType::Node, {{39.2005858, 60.53736258}});

  auto const areaPart1 =
      MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}}, OsmElement::EntityType::Relation,
                    {{39.074534, 60.4989445},  {39.0679785, 60.4905635}, {39.0675323, 60.4899397},
                     {39.0636533, 60.4853405}, {39.0590853, 60.4812033}, {39.0551326, 60.4775753},
                     {39.0504648, 60.4742041}, {39.0467881, 60.4719245}, {39.0429923, 60.4697919},
                     {39.0398945, 60.4691261}, {39.0384817, 60.468709},  {39.0384817, 60.468709},
                     {39.0364008, 60.4680945}, {39.0337705, 60.4669019}, {39.0315385, 60.4659714},
                     {39.0284701, 60.4644107}, {39.0259522, 60.462626},  {39.0232518, 60.4597917},
                     {39.0208024, 60.4564464}, {39.0199627, 60.4552918}, {39.0176608, 60.4518437},
                     {39.0132338, 60.4469233}, {39.0132338, 60.4469233}, {39.0292226, 60.4432002},
                     {39.0309324, 60.4425288}, {39.0309324, 60.4425288}, {39.0307145, 60.4421027},
                     {39.0300749, 60.4406326}, {39.0296959, 60.4397554}, {39.0290986, 60.4378256},
                     {39.0285766, 60.4348871}, {39.0284563, 60.434014},  {39.0285916, 60.4322739},
                     {39.0285328, 60.4311426}, {39.0278766, 60.4288425}, {39.0268417, 60.4246525},
                     {39.0275896, 60.4212829}, {39.0276968, 60.4203925}, {39.0276303, 60.418198},
                     {39.028197, 60.4159742},  {39.028849, 60.4141625},  {39.0310687, 60.4118203},
                     {39.031518, 60.4112606},  {39.0319937, 60.4107157}, {39.0337694, 60.4076787},
                     {39.0346303, 60.4057034}, {39.0355074, 60.4050395}, {39.0361619, 60.4042455},
                     {39.0368269, 60.4016191}, {39.0385044, 60.3959187}, {39.0418776, 60.3905149},
                     {39.0463729, 60.3842885}, {39.0532441, 60.3777555}, {39.0592906, 60.3701493},
                     {39.0615436, 60.3664157}, {39.0626165, 60.3652248}, {39.0641614, 60.3638701},
                     {39.0668932, 60.3624217}, {39.0680353, 60.3618357}, {39.0680353, 60.3618357},
                     {39.0721372, 60.359349},  {39.0721372, 60.359349},  {39.0740941, 60.3581627},
                     {39.0749359, 60.359281},  {39.079018, 60.3562537},  {39.0794019, 60.354685},
                     {39.0794019, 60.354685},  {39.0805906, 60.3498271}, {39.0821251, 60.3500496},
                     {39.0839445, 60.3532185}, {39.0843611, 60.3530262}, {39.0843611, 60.3530262},
                     {39.0845581, 60.3529379}, {39.0869124, 60.3489466}, {39.0885632, 60.3467085},
                     {39.0933362, 60.3492831}, {39.0947304, 60.3503509}, {39.0997245, 60.3567334},
                     {39.0997245, 60.3567334}, {39.1032912, 60.357082},  {39.1059382, 60.3573342},
                     {39.1101709, 60.3583243}, {39.1144932, 60.3594472}, {39.1157532, 60.3596367},
                     {39.117361, 60.359902},   {39.1184208, 60.3600138}, {39.1203173, 60.3580744},
                     {39.1219902, 60.3583593}, {39.1262941, 60.3575794}, {39.1262941, 60.3575794},
                     {39.1237412, 60.3549011}, {39.1227098, 60.3542045}, {39.1203452, 60.3525582},
                     {39.1197664, 60.3521273}, {39.1188233, 60.3508459}, {39.1183308, 60.3498493},
                     {39.1182006, 60.3490173}, {39.11826, 60.346713},    {39.117875, 60.3461498},
                     {39.1164904, 60.3460998}, {39.115364, 60.3458699},  {39.114078, 60.3446772},
                     {39.1139158, 60.3441032}, {39.1139158, 60.3441032}, {39.113871, 60.3435707},
                     {39.1142252, 60.3427219}, {39.1148919, 60.3418121}, {39.115958, 60.3400625},
                     {39.1160004, 60.3384066}, {39.1154308, 60.3368106}, {39.1128315, 60.3362528},
                     {39.1110461, 60.3364721}, {39.1096837, 60.3373646}, {39.109073, 60.3384296},
                     {39.108243, 60.3394476},  {39.10663, 60.3402305},   {39.1040836, 60.3406151},
                     {39.1030062, 60.3405022}, {39.1023422, 60.3398382}, {39.1020666, 60.3384852},
                     {39.10139, 60.3368441},   {39.1005757, 60.3357541}, {39.0982204, 60.3338497},
                     {39.0965666, 60.3327347}, {39.0953389, 60.33172},   {39.0938856, 60.3300913},
                     {39.093397, 60.329089},   {39.0934471, 60.3276858}, {39.093635, 60.3258943},
                     {39.0936225, 60.3243159}, {39.0930337, 60.3228499}, {39.0918936, 60.3218728},
                     {39.0902148, 60.3212088}, {39.0878606, 60.3212463}, {39.085471, 60.3214255},
                     {39.0849333, 60.3169451}, {39.0863073, 60.311688},  {39.0863073, 60.311688},
                     {39.0888537, 60.3101306}, {39.0908582, 60.3083866}, {39.0912266, 60.3081377},
                     {39.0927424, 60.3071137}, {39.0940354, 60.3068731}, {39.0961983, 60.3084753},
                     {39.0982247, 60.3107693}, {39.0986835, 60.3144396}, {39.099438, 60.317613},
                     {39.1006758, 60.318989},  {39.1011563, 60.3170258}, {39.1030494, 60.3175751},
                     {39.1068643, 60.3174692}, {39.1132543, 60.3134163}, {39.11396, 60.306935},
                     {39.1153125, 60.3049514}, {39.1202718, 60.302697},  {39.1254115, 60.3023364},
                     {39.1287478, 60.3016151}, {39.1339579, 60.3020129}, {39.1351185, 60.3001271},
                     {39.137206, 60.2984176},  {39.1378011, 60.2973997}, {39.1392295, 60.2963042},
                     {39.1429381, 60.2945454}, {39.146035, 60.2933219},  {39.167594, 60.2845201},
                     {39.1673725, 60.2838703}, {39.2077052, 60.268394},  {39.2077052, 60.268394},
                     {39.2087758, 60.268088},  {39.209828, 60.2686863},  {39.2236482, 60.2571172},
                     {39.2246857, 60.2559231}, {39.2273088, 60.2556491}, {39.230379, 60.2546161},
                     {39.2350893, 60.260244},  {39.2376637, 60.2656999}, {39.2376637, 60.2656999},
                     {39.2392797, 60.2708269}, {39.240442, 60.2755679},  {39.2420937, 60.2758737},
                     {39.2417878, 60.2846827}, {39.2408914, 60.3009887}, {39.2406621, 60.3093235},
                     {39.2408531, 60.3135674}, {39.2415031, 60.3198759}, {39.2424281, 60.3197796},
                     {39.2539484, 60.3180343}, {39.2541584, 60.3180025}, {39.2675782, 60.3160143},
                     {39.2740397, 60.3150203}, {39.2740397, 60.3150203}, {39.2749734, 60.3419983},
                     {39.275752, 60.3424899},  {39.2708812, 60.3557508}, {39.2812542, 60.3593117},
                     {39.283223, 60.3540214},  {39.2945803, 60.3554009}, {39.2962277, 60.3554009},
                     {39.2972188, 60.3543964}, {39.2975938, 60.3535259}, {39.2976512, 60.3522484},
                     {39.3000274, 60.3459835}, {39.305464, 60.3469016},  {39.2985469, 60.3647129},
                     {39.293506, 60.3632006},  {39.2960938, 60.3559099}, {39.2946503, 60.3558435},
                     {39.283886, 60.3545988},  {39.2765715, 60.3755792}, {39.2779886, 60.3762161},
                     {39.2773621, 60.3779231}, {39.2785723, 60.3784636}, {39.2800477, 60.3776858},
                     {39.2813772, 60.3772282}, {39.283943, 60.3769314},  {39.2902157, 60.3762002},
                     {39.2906903, 60.3828151}, {39.291023, 60.3891575},  {39.2929219, 60.3919373},
                     {39.293979, 60.3912521},  {39.2956429, 60.3895686}, {39.2978941, 60.3881787},
                     {39.2993035, 60.3875524}, {39.300987, 60.3875915},  {39.3010653, 60.3890793},
                     {39.3005368, 60.3940123}, {39.2997538, 60.4000024}, {39.3040682, 60.4014775},
                     {39.3127663, 60.3925882}, {39.3282948, 60.3777679}, {39.331231, 60.3806455},
                     {39.3283731, 60.3861266}, {39.3268071, 60.3881232}, {39.328345, 60.3921937},
                     {39.327458, 60.3966287},  {39.3267239, 60.398831},  {39.3258674, 60.3998709},
                     {39.3256428, 60.4019989}, {39.3260735, 60.4033692}, {39.3262497, 60.4039956},
                     {39.3270131, 60.4051114}, {39.3285987, 60.4065991}, {39.3286378, 60.4071474},
                     {39.3281187, 60.4088279}, {39.3254568, 60.4120033}, {39.3247624, 60.4156997},
                     {39.3259345, 60.4175611}, {39.3287975, 60.4199101}, {39.3288143, 60.4212285},
                     {39.3271259, 60.4209349}, {39.3267177, 60.4221369}, {39.3268946, 60.4354818},
                     {39.3268946, 60.4354818}, {39.3234455, 60.4356568}, {39.3227292, 60.4283031},
                     {39.3170582, 60.428253},  {39.3152786, 60.4282374}, {39.3152786, 60.4282374},
                     {39.3130893, 60.4282181}, {39.3078204, 60.4522924}, {39.3003639, 60.4633539},
                     {39.3015697, 60.4839487}, {39.3017753, 60.4867081}, {39.3024147, 60.4954957},
                     {39.3036255, 60.4954311}, {39.3042343, 60.5008715}, {39.3116875, 60.4983026},
                     {39.3133615, 60.4980633}, {39.3157246, 60.500738},  {39.3154218, 60.5017763},
                     {39.3143403, 60.5016609}, {39.3126721, 60.5019185}, {39.3121571, 60.5022511},
                     {39.311577, 60.5124536},  {39.311573, 60.5127076},  {39.3115653, 60.5129593},
                     {39.3115349, 60.5133153}, {39.3090408, 60.5151322}, {39.3089062, 60.5166257},
                     {39.3085829, 60.51721},   {39.307968, 60.5174115},  {39.3064283, 60.5172574},
                     {39.3049834, 60.518412},  {39.3041794, 60.5195063}, {39.3037477, 60.5209847},
                     {39.3035394, 60.5235956}, {39.3032838, 60.530016},  {39.3027223, 60.5335122},
                     {39.3034859, 60.5341401}, {39.3035297, 60.5341239}, {39.3034808, 60.5349069},
                     {39.3024286, 60.5353963}, {39.3006445, 60.548993},  {39.3006445, 60.548993},
                     {39.3008994, 60.5556406}, {39.3009988, 60.5585426}, {39.3013448, 60.5614449},
                     {39.3021529, 60.562164},  {39.3021529, 60.562164},  {39.3026498, 60.562606},
                     {39.3044529, 60.5638511}, {39.3059691, 60.5646017}, {39.3066746, 60.5647744},
                     {39.306911, 60.5648044},  {39.3069222, 60.5651797}, {39.3066746, 60.5652247},
                     {39.3059991, 60.5655024}, {39.3026216, 60.5676791}, {39.3019761, 60.5687298},
                     {39.3021003, 60.5700593}, {39.3163074, 60.5709238}, {39.3194146, 60.5646444},
                     {39.3211107, 60.5614395}, {39.3212964, 60.5610886}, {39.3266931, 60.5640397},
                     {39.330835, 60.5638531},  {39.3328094, 60.5641037}, {39.3345579, 60.5646188},
                     {39.3345579, 60.5646188}, {39.3317416, 60.5677395}, {39.3326645, 60.5685767},
                     {39.3330356, 60.5727345}, {39.3309367, 60.5751748}, {39.3305788, 60.5760347},
                     {39.3297437, 60.5768636}, {39.3297437, 60.5818681}, {39.3298578, 60.5832858},
                     {39.3306755, 60.585368},  {39.3316085, 60.5858757}, {39.3340388, 60.588322},
                     {39.3396931, 60.5912002}, {39.3385995, 60.5940304}, {39.3467417, 60.5983273},
                     {39.3473938, 60.6031924}, {39.3514231, 60.6031424}, {39.3545997, 60.6097464},
                     {39.3603577, 60.60808},   {39.3648582, 60.6060818}, {39.3663164, 60.6030754},
                     {39.3668564, 60.599907},  {39.3661723, 60.5945965}, {39.3661723, 60.5945965},
                     {39.3674145, 60.5950105}, {39.3700248, 60.5958386}, {39.3709249, 60.5978728},
                     {39.3718395, 60.5984406}, {39.372059, 60.6005552},  {39.3726891, 60.6009332},
                     {39.3730851, 60.6016893}, {39.372311, 60.6019773},  {39.372149, 60.6028053},
                     {39.372383, 60.6036336},  {39.371843, 60.6046596},  {39.3729591, 60.6054336},
                     {39.3727611, 60.6060818}, {39.371519, 60.6061357},  {39.3709609, 60.6059017},
                     {39.3703308, 60.6063518}, {39.3697548, 60.607936},  {39.3709789, 60.6084221},
                     {39.3718468, 60.6088894}, {39.3678424, 60.6174459}, {39.367375, 60.6191103},
                     {39.3688136, 60.6195598}, {39.3688136, 60.6195598}, {39.3753141, 60.6213985},
                     {39.3858234, 60.6248484}, {39.391502, 60.6266435},  {39.391502, 60.6266435},
                     {39.3963226, 60.6281673}, {39.4001924, 60.6293928}, {39.4017524, 60.6294092},
                     {39.4027043, 60.6300776}, {39.4044894, 60.6307354}, {39.417116, 60.6349006},
                     {39.4192352, 60.6292126}, {39.426212, 60.6316035},  {39.4250706, 60.6344354},
                     {39.4318821, 60.6372139}, {39.4345433, 60.639202},  {39.439223, 60.6413125},
                     {39.4464108, 60.6408231}, {39.4481543, 60.6402113}, {39.4575138, 60.6439735},
                     {39.4582785, 60.6446159}, {39.4582785, 60.6446159}, {39.4493885, 60.6579124},
                     {39.4493885, 60.6579124}, {39.4474814, 60.6607045}, {39.4478484, 60.6621725},
                     {39.4369826, 60.6771237}, {39.4366352, 60.6810984}, {39.4366352, 60.6810984},
                     {39.4364313, 60.6822654}, {39.4355144, 60.682907},  {39.4348296, 60.6834951},
                     {39.4342526, 60.6840774}, {39.4287535, 60.6857176}, {39.4253747, 60.685791},
                     {39.4243165, 60.687029},  {39.4211957, 60.6880738}, {39.4206681, 60.689036},
                     {39.4168665, 60.688372},  {39.4156096, 60.6888689}, {39.4158277, 60.691229},
                     {39.4163751, 60.6918299}, {39.416087, 60.6926411},  {39.4182005, 60.6929819},
                     {39.4195288, 60.693217},  {39.4239747, 60.6933205}, {39.4263458, 60.6931226},
                     {39.4263458, 60.6931226}, {39.4263196, 60.6963038}, {39.4297432, 60.6960238},
                     {39.4310689, 60.6961463}, {39.4310689, 60.6961463}, {39.4423719, 60.6985356},
                     {39.4452471, 60.7137373}, {39.4465565, 60.7244651}, {39.4465565, 60.7244651},
                     {39.4078092, 60.7304534}, {39.4061858, 60.725761},  {39.4036409, 60.7265253},
                     {39.404611, 60.7305046},  {39.402436, 60.7308777},  {39.4008629, 60.7311816},
                     {39.3984821, 60.7315881}, {39.3589332, 60.7383393}, {39.3589332, 60.7383393},
                     {39.3590823, 60.7383665}, {39.3591736, 60.7384484}, {39.3592001, 60.738564},
                     {39.3589103, 60.7387503}, {39.3586863, 60.7390682}, {39.3585727, 60.7391061},
                     {39.3583926, 60.7389965}, {39.3584265, 60.7386313}, {39.3582743, 60.738479},
                     {39.3581999, 60.7384795}, {39.3576931, 60.7388254}, {39.3575104, 60.7390063},
                     {39.357512, 60.7390416},  {39.357683, 60.7392339},  {39.3577664, 60.7397321},
                     {39.3579152, 60.7399305}, {39.3581865, 60.7400766}, {39.35851, 60.7400844},
                     {39.3591083, 60.7403941}, {39.3594898, 60.7403544}, {39.3595581, 60.7401607},
                     {39.3595017, 60.7399075}, {39.3595467, 60.7395231}, {39.3600493, 60.739189},
                     {39.3612026, 60.739237},  {39.3618422, 60.7399147}, {39.3618688, 60.7404685},
                     {39.3617072, 60.7411736}, {39.3614372, 60.7418048}, {39.3614873, 60.7426897},
                     {39.360987, 60.7430191},  {39.3608161, 60.7430313}, {39.3605729, 60.7427684},
                     {39.3602726, 60.7427943}, {39.3601035, 60.7428678}, {39.3602499, 60.7436732},
                     {39.3603207, 60.744376},  {39.3605352, 60.7450636}, {39.360415, 60.7454904},
                     {39.3602973, 60.7464665}, {39.3601252, 60.746677},  {39.3597129, 60.7469782},
                     {39.3597078, 60.747788},  {39.3594709, 60.7479558}, {39.359187, 60.7478522},
                     {39.3590487, 60.7479558}, {39.3590167, 60.7484643}, {39.3590462, 60.7489904},
                     {39.3591515, 60.7491202}, {39.3595968, 60.7493162}, {39.3596017, 60.7495212},
                     {39.3595771, 60.7497335}, {39.359103, 60.7501013},  {39.3588142, 60.750595},
                     {39.3585327, 60.7508395}, {39.3584857, 60.7510075}, {39.3585154, 60.751158},
                     {39.3588339, 60.751395},  {39.3594056, 60.7515127}, {39.3594675, 60.7516912},
                     {39.3594918, 60.7521092}, {39.3596232, 60.7522943}, {39.3598663, 60.7524568},
                     {39.3600515, 60.7527409}, {39.3600939, 60.7529642}, {39.360255, 60.7530363},
                     {39.3604599, 60.752861},  {39.3606222, 60.7526967}, {39.3607666, 60.7525063},
                     {39.3608769, 60.7524583}, {39.3611002, 60.7524836}, {39.361298, 60.752618},
                     {39.3613644, 60.7527664}, {39.3613644, 60.7529939}, {39.3612753, 60.7530971},
                     {39.361209, 60.7532807},  {39.3611484, 60.7536571}, {39.3609291, 60.7539648},
                     {39.3609334, 60.7541034}, {39.3611199, 60.7544877}, {39.361527, 60.7548156},
                     {39.3616443, 60.7549966}, {39.3615708, 60.7552467}, {39.3616824, 60.7553457},
                     {39.3620837, 60.7555035}, {39.3622471, 60.7556099}, {39.3625617, 60.7557487},
                     {39.3626892, 60.7559754}, {39.3627189, 60.75611},   {39.3627917, 60.7562078},
                     {39.3629583, 60.7562843}, {39.3631912, 60.7562073}, {39.3634253, 60.756148},
                     {39.3635475, 60.7560834}, {39.3636306, 60.7557562}, {39.3638442, 60.7556985},
                     {39.3641411, 60.7556747}, {39.3641971, 60.7555662}, {39.3641123, 60.7552829},
                     {39.3642309, 60.7551659}, {39.3644312, 60.7551862}, {39.3646584, 60.7551405},
                     {39.364955, 60.7551269},  {39.3651087, 60.7550215}, {39.3652804, 60.7546539},
                     {39.3654883, 60.7545576}, {39.3656148, 60.7546931}, {39.3655636, 60.7552082},
                     {39.3654009, 60.7554462}, {39.3653316, 60.7555578}, {39.3653768, 60.7556572},
                     {39.3658468, 60.7557596}, {39.3661661, 60.7557627}, {39.3665246, 60.7559344},
                     {39.3666843, 60.7560999}, {39.3666791, 60.7562304}, {39.3666451, 60.7563279},
                     {39.3665047, 60.7563868}, {39.3664231, 60.7566337}, {39.3659089, 60.7573018},
                     {39.3659089, 60.7574899}, {39.3662228, 60.7579352}, {39.3666061, 60.75793},
                     {39.3669604, 60.7582042}, {39.3671051, 60.7584563}, {39.3670592, 60.75871},
                     {39.3669314, 60.7588599}, {39.3669757, 60.759037},  {39.3671545, 60.7594066},
                     {39.367301, 60.7594304},  {39.3675156, 60.7593623}, {39.3677659, 60.7594525},
                     {39.3677608, 60.7596483}, {39.3676127, 60.7598629}, {39.367502, 60.7600384},
                     {39.3675377, 60.7601797}, {39.3676144, 60.7601984}, {39.3678517, 60.7600971},
                     {39.3681022, 60.7601267}, {39.3682646, 60.7602982}, {39.3682977, 60.7605425},
                     {39.3681734, 60.7606392}, {39.3679493, 60.7605953}, {39.3678458, 60.760604},
                     {39.367731, 60.7606726},  {39.3676901, 60.7607977}, {39.367761, 60.760958},
                     {39.3679113, 60.7612194}, {39.3679292, 60.7612697}, {39.3680043, 60.7615166},
                     {39.3679056, 60.7616138}, {39.3677666, 60.7617723}, {39.3675767, 60.7618591},
                     {39.3672453, 60.7617847}, {39.3668742, 60.7615829}, {39.3666776, 60.7614305},
                     {39.3665367, 60.7611932}, {39.3663385, 60.7610658}, {39.366217, 60.7611011},
                     {39.3659725, 60.7612523}, {39.3657724, 60.7614251}, {39.3656002, 60.7619025},
                     {39.3654932, 60.762266},  {39.3652139, 60.7627849}, {39.3645991, 60.7632498},
                     {39.3643306, 60.7635255}, {39.3640787, 60.763905},  {39.3640609, 60.7641188},
                     {39.3638915, 60.7643176}, {39.3638436, 60.7646903}, {39.3638499, 60.7649199},
                     {39.3639038, 60.7650786}, {39.3638699, 60.7654253}, {39.3637104, 60.7658171},
                     {39.3637554, 60.7662578}, {39.3636542, 60.7665613}, {39.3637314, 60.7667334},
                     {39.3639266, 60.7667919}, {39.3640171, 60.7666021}, {39.3640845, 60.766582},
                     {39.3642229, 60.7665204}, {39.3644855, 60.7666027}, {39.3645991, 60.7669586},
                     {39.3645635, 60.7670795}, {39.3643932, 60.7671681}, {39.3641005, 60.7674325},
                     {39.36412, 60.7676045},   {39.3643063, 60.7676791}, {39.3645245, 60.7676603},
                     {39.3648643, 60.767808},  {39.3653001, 60.7681175}, {39.3652983, 60.7684198},
                     {39.3651453, 60.7686955}, {39.3652247, 60.7689479}, {39.3652962, 60.7690314},
                     {39.3653566, 60.7691803}, {39.3657062, 60.7697114}, {39.366399, 60.7706363},
                     {39.3669171, 60.771202},  {39.3671205, 60.7714723}, {39.3674637, 60.7717233},
                     {39.3681361, 60.7727795}, {39.3686628, 60.7732749}, {39.3693674, 60.773468},
                     {39.3698564, 60.7741393}, {39.3703943, 60.7744495}, {39.3712066, 60.7755462},
                     {39.3714814, 60.7757724}, {39.3718486, 60.7770151}, {39.3725285, 60.7774151},
                     {39.3734269, 60.7775193}, {39.3739814, 60.7775128}, {39.3745876, 60.7773266},
                     {39.3751649, 60.7774156}, {39.3757615, 60.7780349}, {39.3761322, 60.7781706},
                     {39.3763628, 60.7779288}, {39.3763387, 60.7776069}, {39.3759939, 60.7771002},
                     {39.3761766, 60.7766989}, {39.376543, 60.7765466},  {39.3769483, 60.7765628},
                     {39.3775482, 60.776887},  {39.378228, 60.7770232},  {39.3788462, 60.7774124},
                     {39.3808857, 60.7794285}, {39.3826802, 60.7807095}, {39.3835367, 60.7809909},
                     {39.3841283, 60.7816774}, {39.3841409, 60.7820834}, {39.3840182, 60.7827732},
                     {39.3833732, 60.7832923}, {39.3833767, 60.7848715}, {39.3823762, 60.7862636},
                     {39.3818685, 60.7868076}, {39.3809478, 60.787058},  {39.3804323, 60.7871167},
                     {39.3804106, 60.7874567}, {39.3806046, 60.7876639}, {39.3808454, 60.7881196},
                     {39.3811547, 60.7885106}, {39.3827282, 60.7894831}, {39.3840971, 60.7906266},
                     {39.3843981, 60.7918802}, {39.3840601, 60.7930658}, {39.3833189, 60.7938637},
                     {39.3832662, 60.7947394}, {39.3834263, 60.7956248}, {39.3836624, 60.7967835},
                     {39.384434, 60.7993788},  {39.385291, 60.8005561},  {39.3860103, 60.8009802},
                     {39.3862, 60.8034728},    {39.3865338, 60.8048686}, {39.3864933, 60.8057589},
                     {39.3868585, 60.8065811}, {39.387502, 60.8079652},  {39.387502, 60.8079652},
                     {39.3870434, 60.8086982}, {39.3867144, 60.8090594}, {39.3866034, 60.8093016},
                     {39.3865985, 60.8097296}, {39.3867394, 60.8101215}, {39.3869957, 60.8104504},
                     {39.3870384, 60.8108097}, {39.3869754, 60.8111514}, {39.3867394, 60.8115229},
                     {39.3861729, 60.8121043}, {39.3851303, 60.8127861}, {39.3846981, 60.8130065},
                     {39.3844476, 60.8130804}, {39.3841317, 60.8130065}, {39.3837575, 60.8124401},
                     {39.3835588, 60.8122484}, {39.3832963, 60.8121637}, {39.3829126, 60.8123124},
                     {39.3825762, 60.8127466}, {39.3824223, 60.8132898}, {39.3824692, 60.8136355},
                     {39.3821593, 60.8143721}, {39.3818447, 60.8150883}, {39.3816172, 60.815376},
                     {39.3812498, 60.8156576}, {39.3809629, 60.8159639}, {39.3806181, 60.8164071},
                     {39.3806739, 60.8169629}, {39.3808944, 60.8177307}, {39.3814753, 60.8193524},
                     {39.38083, 60.8205586},   {39.3807012, 60.8210522}, {39.3807783, 60.8213758},
                     {39.3824248, 60.82136},   {39.3830183, 60.8222001}, {39.3830747, 60.8244322},
                     {39.3824789, 60.8253168}, {39.3815131, 60.8258504}, {39.3798251, 60.8262194},
                     {39.3797678, 60.8268425}, {39.3801445, 60.8276581}, {39.3799871, 60.8280527},
                     {39.379748, 60.8284423},  {39.3800511, 60.8290437}, {39.380368, 60.8291926},
                     {39.3813391, 60.8294595}, {39.3816013, 60.8295727}, {39.3816809, 60.8298718},
                     {39.3814362, 60.8302966}, {39.3812645, 60.8306791}, {39.3812541, 60.8310957},
                     {39.3812949, 60.8313723}, {39.3814327, 60.8316467}, {39.3816684, 60.831792},
                     {39.3822807, 60.8320161}, {39.3827056, 60.8322488}, {39.3828635, 60.8322914},
                     {39.3831305, 60.8321476}, {39.3833097, 60.8320007}, {39.3838486, 60.8321324},
                     {39.3842229, 60.8320212}, {39.3843725, 60.8319997}, {39.3845821, 60.8321574},
                     {39.384562, 60.8324584},  {39.3845906, 60.8325979}, {39.3847337, 60.8326635},
                     {39.385011, 60.8325855},  {39.3853766, 60.8326382}, {39.385551, 60.8328485},
                     {39.3856408, 60.8331878}, {39.3855226, 60.833594},  {39.3855011, 60.8338457},
                     {39.3855795, 60.8341481}, {39.385578, 60.8349811},  {39.3853598, 60.8356313},
                     {39.3849157, 60.8361986}, {39.3845801, 60.8364215}, {39.3844606, 60.8366083},
                     {39.3843759, 60.8371015}, {39.3844225, 60.8375956}, {39.3846578, 60.8380749},
                     {39.384792, 60.8381866},  {39.38477, 60.8383973},   {39.3845393, 60.8385249},
                     {39.3843197, 60.8385492}, {39.3839706, 60.8384339}, {39.3838097, 60.8384004},
                     {39.3834946, 60.8385605}, {39.383468, 60.8388494},  {39.3834711, 60.8393577},
                     {39.3833329, 60.8395251}, {39.3830942, 60.8395518}, {39.3826302, 60.8395384},
                     {39.3819684, 60.8394877}, {39.3818684, 60.8391899}, {39.3817406, 60.8389632},
                     {39.381458, 60.8388598},  {39.3812456, 60.8389812}, {39.3813186, 60.8397127},
                     {39.3814742, 60.8403711}, {39.3816794, 60.8409309}, {39.3823271, 60.8415473},
                     {39.3830653, 60.8420778}, {39.3833168, 60.8425103}, {39.3835612, 60.8432301},
                     {39.3842663, 60.8435189}, {39.3846739, 60.8435511}, {39.3849843, 60.8437981},
                     {39.3850938, 60.8449307}, {39.3853713, 60.845611},  {39.385822, 60.8461475},
                     {39.386629, 60.8472838},  {39.387088, 60.8480411},  {39.3875296, 60.8486492},
                     {39.3877639, 60.8488458}, {39.3881147, 60.8486562}, {39.3881169, 60.8481316},
                     {39.3882105, 60.847843},  {39.3884451, 60.8477513}, {39.3886332, 60.8479778},
                     {39.3889334, 60.8486955}, {39.3890308, 60.8495479}, {39.3891372, 60.850439},
                     {39.389048, 60.8513337},  {39.3882467, 60.8526276}, {39.3873171, 60.8538228},
                     {39.3873981, 60.8540237}, {39.3878632, 60.8542075}, {39.3881126, 60.854304},
                     {39.3882951, 60.8544832}, {39.3883755, 60.8549049}, {39.388322, 60.8553333},
                     {39.3878685, 60.8562486}, {39.3876164, 60.85671},   {39.3873583, 60.8572544},
                     {39.3870869, 60.8582247}, {39.3868064, 60.8589522}, {39.3863113, 60.8595507},
                     {39.3861009, 60.8596524}, {39.3858507, 60.8596066}, {39.3857465, 60.8593609},
                     {39.3857549, 60.858888},  {39.3856396, 60.8585902}, {39.385232, 60.8585463},
                     {39.3850596, 60.8585983}, {39.3851027, 60.8588635}, {39.3847504, 60.8590424},
                     {39.3841551, 60.8592563}, {39.3839161, 60.8591185}, {39.3834614, 60.8590347},
                     {39.3829781, 60.8590745}, {39.3826127, 60.8591919}, {39.3824131, 60.8594582},
                     {39.3821259, 60.8598699}, {39.3817799, 60.8604711}, {39.3817166, 60.8609792},
                     {39.3815385, 60.8614334}, {39.3812343, 60.8618045}, {39.3805543, 60.8625275},
                     {39.3802341, 60.8627124}, {39.3798766, 60.8625683}, {39.3797786, 60.862334},
                     {39.3797526, 60.8621373}, {39.3794166, 60.8626059}, {39.3794138, 60.8630614},
                     {39.3794765, 60.8634835}, {39.3787556, 60.86397},   {39.3781866, 60.8645389},
                     {39.3781866, 60.8645389}, {39.3780521, 60.8648428}, {39.3780551, 60.8654606},
                     {39.3782602, 60.8659295}, {39.3792151, 60.8675964}, {39.3796791, 60.8687858},
                     {39.379858, 60.8689957},  {39.3799276, 60.869532},  {39.3804858, 60.8697163},
                     {39.3803013, 60.8702216}, {39.3803013, 60.8702216}, {39.3794977, 60.8701099},
                     {39.3790968, 60.8701244}, {39.3786931, 60.8701306}, {39.3784357, 60.8697873},
                     {39.3779207, 60.8696156}, {39.3776632, 60.8697748}, {39.3776632, 60.8697748},
                     {39.3775627, 60.8707246}, {39.3760324, 60.8721779}, {39.3747449, 60.8728646},
                     {39.3736018, 60.8734027}, {39.3721808, 60.8729211}, {39.3713117, 60.8734654},
                     {39.3706666, 60.8739563}, {39.3698903, 60.8744567}, {39.3697467, 60.8746338},
                     {39.3697467, 60.8746338}, {39.3651032, 60.8741594}, {39.3623772, 60.8743899},
                     {39.3619106, 60.8750592}, {39.35963, 60.8784419},   {39.3577467, 60.8771992},
                     {39.3577467, 60.8771992}, {39.3584476, 60.876563},  {39.3596633, 60.8750168},
                     {39.3607623, 60.8722916}, {39.3612547, 60.8698211}, {39.3610701, 60.8678383},
                     {39.3604116, 60.8663375}, {39.3591175, 60.8640173}, {39.3576198, 60.862279},
                     {39.3559492, 60.8612081}, {39.3533183, 60.8606785}, {39.3516485, 60.8608173},
                     {39.3495838, 60.861753},  {39.3481542, 60.8629834}, {39.3468653, 60.8634882},
                     {39.3448637, 60.8635396}, {39.3432535, 60.863444},  {39.3416705, 60.8634735},
                     {39.340865, 60.8640445},  {39.3400605, 60.8651296}, {39.3397396, 60.8666589},
                     {39.340082, 60.868477},   {39.338931, 60.869521},   {39.3380439, 60.8696681},
                     {39.3372596, 60.8694313}, {39.3367697, 60.868585},  {39.3362405, 60.8661394},
                     {39.3360555, 60.8650941}, {39.335879, 60.8637611},  {39.3355401, 60.8625104},
                     {39.335138, 60.8618518},  {39.3344714, 60.8611916}, {39.3337305, 60.860707},
                     {39.3326791, 60.8606663}, {39.3317135, 60.8609024}, {39.331335, 60.8614871},
                     {39.3314095, 60.8622361}, {39.3312192, 60.8629754}, {39.3309226, 60.8635815},
                     {39.3301472, 60.8642496}, {39.3293692, 60.8648009}, {39.3285991, 60.8650711},
                     {39.3275926, 60.8650093}, {39.325406, 60.8642403},  {39.3229466, 60.8634342},
                     {39.3210379, 60.8625649}, {39.3191178, 60.8615676}, {39.3176468, 60.8601464},
                     {39.3166931, 60.8582631}, {39.3166287, 60.8558169}, {39.3142039, 60.8504311},
                     {39.3137749, 60.8472768}, {39.3073805, 60.8409467}, {39.3023594, 60.835754},
                     {39.3013723, 60.8325568}, {39.301298, 60.8314029},  {39.3006441, 60.8269189},
                     {39.3006656, 60.8196877}, {39.3002794, 60.8166191}, {39.299464, 60.8152888},
                     {39.2985627, 60.8146237}, {39.2969105, 60.814452},  {39.294872, 60.8153747},
                     {39.2934557, 60.8160184}, {39.2919109, 60.815482},  {39.2904517, 60.8125851},
                     {39.2887137, 60.8110187}, {39.2868898, 60.8105038}, {39.2835638, 60.8105252},
                     {39.2819545, 60.8092378}, {39.2814395, 60.8082293}, {39.2814854, 60.8069483},
                     {39.2814854, 60.8069483}, {39.2816326, 60.8028434}, {39.281182, 60.7990669},
                     {39.280946, 60.7973288},  {39.28071, 60.7942388},   {39.2805383, 60.7924364},
                     {39.2792079, 60.7888315}, {39.2745731, 60.7830594}, {39.2721054, 60.779991},
                     {39.2721054, 60.779991},  {39.2715261, 60.7779377}, {39.2699544, 60.7788766},
                     {39.2691013, 60.7788979}, {39.2686684, 60.7786448}, {39.2677625, 60.7783024},
                     {39.2677979, 60.779531},  {39.2680071, 60.7797348}, {39.2674814, 60.7800407},
                     {39.2660168, 60.7815211}, {39.2649118, 60.781135},  {39.2651917, 60.780231},
                     {39.2644066, 60.7784397}, {39.2636814, 60.7778193}, {39.2627148, 60.7771125},
                     {39.2625354, 60.7773101}, {39.2622081, 60.7772995}, {39.2618863, 60.7771224},
                     {39.2606954, 60.7789033}, {39.2597564, 60.7774719}, {39.25958, 60.7771295},
                     {39.2590646, 60.7750195}, {39.2574105, 60.7747104}, {39.2567201, 60.7747829},
                     {39.2568648, 60.7756567}, {39.2567008, 60.7758306}, {39.2570049, 60.7765162},
                     {39.2566863, 60.7767093}, {39.2568505, 60.7770569}, {39.2568505, 60.7770569},
                     {39.2556808, 60.7783458}, {39.2554196, 60.7783658}, {39.2543546, 60.7778033},
                     {39.2541939, 60.7766781}, {39.2538322, 60.776477},  {39.2527472, 60.7745081},
                     {39.2498072, 60.7754807}, {39.2470979, 60.7797799}, {39.2466792, 60.7809377},
                     {39.2392047, 60.7828666}, {39.239044, 60.7826657},  {39.2496529, 60.7740659},
                     {39.2519499, 60.7731652}, {39.2527455, 60.7714035}, {39.2521772, 60.7687893},
                     {39.2510406, 60.7675958}, {39.2489947, 60.7669706}, {39.24621, 60.7684482},
                     {39.244849, 60.7702758},  {39.2453053, 60.7725699}, {39.2397881, 60.7750974},
                     {39.2327979, 60.7728243}, {39.2302974, 60.7724265}, {39.2256372, 60.774586},
                     {39.2210339, 60.7690734}, {39.2229377, 60.7688548}, {39.2250412, 60.7680861},
                     {39.2294021, 60.7652243}, {39.2268569, 60.7611643}, {39.2223259, 60.7553317},
                     {39.2186797, 60.7547686}, {39.2186797, 60.7547686}, {39.2166289, 60.7546763},
                     {39.21481, 60.7541095},   {39.2114927, 60.7501929}, {39.2010451, 60.7310453},
                     {39.1947324, 60.7186209}, {39.1940148, 60.7186303}, {39.1940148, 60.7186303},
                     {39.1929596, 60.7135347}, {39.1929596, 60.7135347}, {39.1929381, 60.7135384},
                     {39.1926754, 60.7135833}, {39.1922298, 60.7136597}, {39.1922298, 60.7136597},
                     {39.1919116, 60.713705},  {39.1888979, 60.7141327}, {39.1888979, 60.7141327},
                     {39.1880892, 60.7106502}, {39.1879727, 60.709759},  {39.187914, 60.7091062},
                     {39.1878863, 60.7087296}, {39.1883355, 60.708664},  {39.1882423, 60.7081112},
                     {39.1879348, 60.7082149}, {39.1878899, 60.7081112}, {39.1876061, 60.7080739},
                     {39.1874603, 60.7080249}, {39.1871713, 60.7079178}, {39.1866739, 60.7078659},
                     {39.1863975, 60.7080249}, {39.1859173, 60.7080835}, {39.1853897, 60.7080567},
                     {39.1849811, 60.7082149}, {39.1848118, 60.7084602}, {39.1847427, 60.7084326},
                     {39.1846667, 60.7082666}, {39.1842382, 60.7083495}, {39.1833747, 60.7085568},
                     {39.1832641, 60.7089335}, {39.1830843, 60.7089366}, {39.1829112, 60.7091836},
                     {39.1834477, 60.7117371}, {39.1807226, 60.7118014}, {39.1807226, 60.7118014},
                     {39.1804479, 60.7116133}, {39.1804479, 60.7116133}, {39.1711657, 60.6934705},
                     {39.1711657, 60.6934705}, {39.1693903, 60.6900539}, {39.1693903, 60.6900539},
                     {39.1670095, 60.6905592}, {39.1666335, 60.6892093}, {39.1653307, 60.6894434},
                     {39.1653307, 60.6894434}, {39.1621514, 60.6895132}, {39.162135, 60.6902023},
                     {39.1617133, 60.6902371}, {39.1616998, 60.6918047}, {39.1602775, 60.6918381},
                     {39.1602495, 60.6913286}, {39.1591231, 60.6912582}, {39.1590514, 60.6902413},
                     {39.1590027, 60.6895466}, {39.1581001, 60.6895481}, {39.1579375, 60.6887479},
                     {39.1578532, 60.6877115}, {39.1583431, 60.6876104}, {39.1582188, 60.6869091},
                     {39.1602567, 60.6866911}, {39.1604119, 60.6860273}, {39.1613131, 60.6860048},
                     {39.1615707, 60.6856018}, {39.1626644, 60.6855198}, {39.1636792, 60.686174},
                     {39.1636792, 60.686174},  {39.1645831, 60.6865985}, {39.1649631, 60.6877367},
                     {39.1655263, 60.6876563}, {39.1658424, 60.6889681}, {39.1686459, 60.6884462},
                     {39.166694, 60.684668},   {39.1652889, 60.6819339}, {39.1649497, 60.6810895},
                     {39.1647075, 60.6804319}, {39.1644514, 60.6795253}, {39.1641537, 60.6783486},
                     {39.164043, 60.6776702},  {39.163953, 60.6766874},  {39.1639288, 60.675964},
                     {39.1639426, 60.6752095}, {39.1638645, 60.6751932}, {39.1638645, 60.6751932},
                     {39.1636553, 60.6748951}, {39.1636553, 60.6748951}, {39.1633664, 60.6755132},
                     {39.1620407, 60.6747767}, {39.1616145, 60.6754307}, {39.1613494, 60.6757161},
                     {39.1613458, 60.6757199}, {39.1610141, 60.6761691}, {39.1610141, 60.6761691},
                     {39.1607881, 60.6764753}, {39.1607881, 60.6764753}, {39.1607335, 60.6765493},
                     {39.1603395, 60.6772572}, {39.1597249, 60.6783615}, {39.1592714, 60.6779979},
                     {39.1592714, 60.6779979}, {39.1585192, 60.6778193}, {39.1587072, 60.6771141},
                     {39.1584954, 60.6769636}, {39.153677, 60.677415},   {39.1526708, 60.6774055},
                     {39.1507262, 60.6777029}, {39.1506764, 60.6777104}, {39.1498955, 60.6777726},
                     {39.1489879, 60.677845},  {39.1459251, 60.6780892}, {39.1448019, 60.6781787},
                     {39.1447123, 60.6778187}, {39.1441157, 60.6747943}, {39.1436984, 60.6734998},
                     {39.1430578, 60.6734985}, {39.1423721, 60.6736492}, {39.141898, 60.6738049},
                     {39.1419971, 60.6740951}, {39.1419152, 60.6741379}, {39.1417029, 60.6742298},
                     {39.1415443, 60.674116},  {39.1413853, 60.6782394}, {39.1383174, 60.6771543},
                     {39.140506, 60.6743414},  {39.1403559, 60.6743203}, {39.1403188, 60.6743119},
                     {39.1399996, 60.6742392}, {39.1399055, 60.6740685}, {39.1398745, 60.6740123},
                     {39.1398244, 60.6739084}, {39.139655, 60.6735578},  {39.1391778, 60.673296},
                     {39.1391651, 60.673289},  {39.1387829, 60.6734893}, {39.1382804, 60.6733415},
                     {39.1382804, 60.6733415}, {39.1364566, 60.6730238}, {39.1364566, 60.6730238},
                     {39.1373136, 60.6676373}, {39.1367211, 60.6666879}, {39.1367863, 60.6657977},
                     {39.1367137, 60.6645684}, {39.1363525, 60.6624237}, {39.1359295, 60.6604454},
                     {39.1354017, 60.6598115}, {39.1349164, 60.6591683}, {39.1347061, 60.6589603},
                     {39.1344061, 60.658079},  {39.1343154, 60.6544093}, {39.1337902, 60.6528918},
                     {39.1332648, 60.6514345}, {39.1333174, 60.6507274}, {39.1322643, 60.6495766},
                     {39.1311812, 60.6489146}, {39.1305346, 60.6478046}, {39.1306199, 60.6476437},
                     {39.1296723, 60.6458906}, {39.1286388, 60.6442886}, {39.1275695, 60.6431144},
                     {39.1260609, 60.6413089}, {39.1237516, 60.6380907}, {39.122466, 60.6371541},
                     {39.1202441, 60.6361074}, {39.116608, 60.6347668},  {39.11479, 60.6346566},
                     {39.11479, 60.6346566},   {39.1131669, 60.6350372}, {39.1121312, 60.6307225},
                     {39.1115117, 60.6271944}, {39.110867, 60.6268382},  {39.1102702, 60.6205945},
                     {39.1096733, 60.618804},  {39.1080206, 60.6149476}, {39.1059726, 60.6114809},
                     {39.1042772, 60.6090386}, {39.1034517, 60.6078495}, {39.1020356, 60.6054971},
                     {39.0987634, 60.6035601}, {39.0974232, 60.603347},  {39.0961428, 60.6023463},
                     {39.094699, 60.6018808},  {39.093164, 60.6019453},  {39.0927901, 60.6020344},
                     {39.0927901, 60.6020344}, {39.0908621, 60.6024938}, {39.0898627, 60.6025409},
                     {39.0884213, 60.6031724}, {39.0869069, 60.6024131}, {39.0874503, 60.6036316},
                     {39.0870531, 60.603939},  {39.0839177, 60.6059448}, {39.0842168, 60.606579},
                     {39.082394, 60.6089421},  {39.0816136, 60.6089045}, {39.0816042, 60.6103149},
                     {39.0806546, 60.6121577}, {39.0808425, 60.613521},  {39.0804947, 60.6159562},
                     {39.0790932, 60.6201271}, {39.0775616, 60.622367},  {39.0746668, 60.6243017},
                     {39.0728914, 60.6250398}, {39.0702083, 60.6250341}, {39.0689044, 60.624171},
                     {39.0679128, 60.6219857}, {39.0673435, 60.6208472}, {39.0675639, 60.6144565},
                     {39.0653602, 60.6134833}, {39.0644053, 60.6125098}, {39.0634503, 60.6102143},
                     {39.0630087, 60.6073537}, {39.0630266, 60.6063403}, {39.06134, 60.6035438},
                     {39.0592917, 60.601363},  {39.0577895, 60.598861},  {39.0612667, 60.5957567},
                     {39.0649022, 60.5943114}, {39.0595021, 60.5902343}, {39.056567, 60.591372},
                     {39.0554101, 60.5864061}, {39.0546168, 60.583958},  {39.0521549, 60.5821625},
                     {39.0440392, 60.5818647}, {39.0430364, 60.5813185}, {39.0430364, 60.5813185},
                     {39.0442178, 60.5785956}, {39.0460675, 60.5728621}, {39.0493924, 60.573944},
                     {39.0516316, 60.5730794}, {39.0576664, 60.5756923}, {39.0650254, 60.5692313},
                     {39.07058, 60.56373},     {39.0713164, 60.5630871}, {39.0702443, 60.5616339},
                     {39.0737686, 60.5553721}, {39.0731672, 60.5549277}, {39.0761617, 60.5522271},
                     {39.0799856, 60.5435022}, {39.0845975, 60.5422713}, {39.0849514, 60.5405316},
                     {39.0849514, 60.5405316}, {39.0831578, 60.539268},  {39.0817256, 60.5375887},
                     {39.0817416, 60.5349443}, {39.0819822, 60.5322787}, {39.082949, 60.5265732},
                     {39.0855607, 60.5203736}, {39.0857793, 60.5197705}, {39.0858319, 60.5194978},
                     {39.0858319, 60.5194978}, {39.0839032, 60.5197573}, {39.0656917, 60.5221284},
                     {39.0634815, 60.5224153}, {39.0634138, 60.5219218}, {39.0635885, 60.5218609},
                     {39.0639711, 60.5211452}, {39.0639756, 60.5208753}, {39.0635833, 60.5198633},
                     {39.0617735, 60.5163554}, {39.0598699, 60.5127537}, {39.0594012, 60.511903},
                     {39.058947, 60.5114991},  {39.0583233, 60.5112972}, {39.0580817, 60.5111567},
                     {39.0578654, 60.5109332}, {39.0574796, 60.5102913}, {39.0573895, 60.5099669},
                     {39.0574111, 60.5093541}, {39.0573895, 60.508871},  {39.0572705, 60.5083661},
                     {39.0565315, 60.5065671}, {39.0558717, 60.5052836}, {39.0549416, 60.504029},
                     {39.0534959, 60.5024211}, {39.0514804, 60.5001536}, {39.0511669, 60.4997965},
                     {39.0496022, 60.4980337}, {39.0489208, 60.497071},  {39.0482539, 60.4972836},
                     {39.0478373, 60.4969471}, {39.0473653, 60.496974},  {39.0464962, 60.4956651},
                     {39.048701, 60.495083},   {39.0490182, 60.4951783}, {39.049436, 60.4954571},
                     {39.0499384, 60.494985},  {39.0532603, 60.4986839}, {39.0566832, 60.5031153},
                     {39.05748, 60.5039807},   {39.0584321, 60.505753},  {39.0594408, 60.5078646},
                     {39.0605908, 60.5108811}, {39.061255, 60.5122011},  {39.0623819, 60.5141428},
                     {39.063243, 60.5154205},  {39.0640309, 60.516751},  {39.0646518, 60.5176693},
                     {39.0650901, 60.5191406}, {39.0656723, 60.5212038}, {39.0658838, 60.5215053},
                     {39.0662078, 60.5216313}, {39.0829915, 60.5194067}, {39.0873385, 60.5189737},
                     {39.0832019, 60.5141536}, {39.0831376, 60.5138536}, {39.0831376, 60.5138536},
                     {39.0826737, 60.5122797}, {39.0821455, 60.5121339}, {39.0814726, 60.5113937},
                     {39.0799613, 60.5079542}, {39.0785289, 60.5025001}, {39.0785289, 60.5025001},
                     {39.074534, 60.4989445}});

  auto const areaPart2 =
      MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}}, OsmElement::EntityType::Relation,
                    {{39.5946606, 60.8875289}, {39.5968517, 60.8869367}, {39.5972678, 60.8879075},
                     {39.5986103, 60.8876559}, {39.5982294, 60.8865667}, {39.6055335, 60.8844839},
                     {39.6191364, 60.8802595}, {39.6286584, 60.877039},  {39.6301079, 60.8766673},
                     {39.6313778, 60.8764702}, {39.6317262, 60.876505},  {39.6325422, 60.8765938},
                     {39.634078, 60.8770359},  {39.6347191, 60.8773924}, {39.635447, 60.8781113},
                     {39.6368783, 60.880108},  {39.6377176, 60.8808965}, {39.6390401, 60.8816509},
                     {39.6423185, 60.8824302}, {39.6456165, 60.8833201}, {39.6470101, 60.8836975},
                     {39.6476579, 60.8837482}, {39.6485349, 60.8836432}, {39.6513069, 60.8828246},
                     {39.6513069, 60.8828246}, {39.6521335, 60.8832661}, {39.6524211, 60.8836576},
                     {39.6527818, 60.8842148}, {39.6539063, 60.8844241}, {39.6551225, 60.8846202},
                     {39.6543976, 60.8849724}, {39.6493714, 60.8884477}, {39.6426274, 60.8919149},
                     {39.6414069, 60.8920628}, {39.6430342, 60.8942449}, {39.6453643, 60.8938381},
                     {39.6473183, 60.8928851}, {39.6472667, 60.8923942}, {39.6472517, 60.8916301},
                     {39.6477421, 60.8907508}, {39.6488097, 60.8908887}, {39.6493376, 60.8912966},
                     {39.6495535, 60.8919444}, {39.65005, 60.8931992},   {39.6548359, 60.8920746},
                     {39.6567973, 60.8927024}, {39.6583664, 60.8925716}, {39.6596479, 60.8914732},
                     {39.658968, 60.8908717},  {39.6589023, 60.8870805}, {39.6589523, 60.8856009},
                     {39.6587403, 60.8855838}, {39.658523, 60.886978},   {39.6581896, 60.8878542},
                     {39.6572372, 60.8880021}, {39.6563773, 60.8860512}, {39.6554342, 60.884433},
                     {39.6541187, 60.88422},   {39.6530963, 60.884057},  {39.6525504, 60.8831694},
                     {39.6518007, 60.8826616}, {39.651681, 60.8824671},  {39.651681, 60.8824671},
                     {39.6509013, 60.8826646}, {39.6491612, 60.8831207}, {39.6481088, 60.8834785},
                     {39.6474002, 60.8835556}, {39.6468108, 60.8834012}, {39.6453725, 60.8829943},
                     {39.6437508, 60.882597},  {39.6419565, 60.8821976}, {39.6401832, 60.8816778},
                     {39.6388317, 60.8811563}, {39.6376584, 60.880528},  {39.6370055, 60.8798228},
                     {39.6359197, 60.8783514}, {39.6352398, 60.8775649}, {39.6345547, 60.877022},
                     {39.6333095, 60.8765653}, {39.6322361, 60.8763473}, {39.6319032, 60.8763006},
                     {39.6319032, 60.8763006}, {39.6319195, 60.8760831}, {39.6320477, 60.8758773},
                     {39.6368601, 60.8743827}, {39.637021, 60.8744846},  {39.6379222, 60.8761046},
                     {39.6384694, 60.8766357}, {39.6380831, 60.8768772}, {39.6385445, 60.8774512},
                     {39.6390112, 60.8771132}, {39.6396979, 60.8779178}, {39.6404489, 60.8782772},
                     {39.6418972, 60.8775853}, {39.6443005, 60.8784059}, {39.6446278, 60.8776925},
                     {39.6475353, 60.8755574}, {39.6462264, 60.8736316}, {39.6450676, 60.8754233},
                     {39.6425195, 60.8745544}, {39.6398856, 60.8729022}, {39.6411302, 60.8718775},
                     {39.6405614, 60.8709118}, {39.6391775, 60.8719042}, {39.6392258, 60.8723549},
                     {39.6386357, 60.8729022}, {39.6382119, 60.8726231}, {39.6377667, 60.8730737},
                     {39.6378471, 60.8733527}, {39.6377452, 60.8735082}, {39.6367384, 60.8740927},
                     {39.6318283, 60.8755843}, {39.6314688, 60.8759545}, {39.6313685, 60.8762914},
                     {39.6313685, 60.8762914}, {39.630195, 60.8764159},  {39.5945785, 60.8871764},
                     {39.5919657, 60.8781552}, {39.5928287, 60.8769627}, {39.6005411, 60.8735968},
                     {39.6005411, 60.8735968}, {39.5976054, 60.8676474}, {39.5939809, 60.8687199},
                     {39.5943137, 60.8704582}, {39.5845174, 60.8784659}, {39.5837184, 60.8780203},
                     {39.5830939, 60.8782535}, {39.5835092, 60.8799295}, {39.5839792, 60.8802805},
                     {39.5835354, 60.8831493}, {39.5842152, 60.8842446}, {39.5833523, 60.88414},
                     {39.5821493, 60.8843753}, {39.5816001, 60.8860492}, {39.5811293, 60.8876967},
                     {39.5813124, 60.8858399}, {39.5812601, 60.88482},   {39.5800308, 60.8848462},
                     {39.5799262, 60.8872783}, {39.5796125, 60.8888735}, {39.5803448, 60.8898673},
                     {39.5797956, 60.8905213}, {39.5782003, 60.8908351}, {39.5781146, 60.8905414},
                     {39.5779781, 60.8905736}, {39.5740415, 60.8774795}, {39.5753507, 60.8771213},
                     {39.5744063, 60.8734868}, {39.576217, 60.8732588},  {39.5756113, 60.8723404},
                     {39.5754029, 60.8714806}, {39.574771, 60.870901},   {39.5729864, 60.8714415},
                     {39.5728675, 60.871084},  {39.5728557, 60.8710875}, {39.5719833, 60.8713504},
                     {39.5778618, 60.8906084}, {39.575843, 60.8911816},  {39.5753602, 60.8896041},
                     {39.5765571, 60.8892074}, {39.5762171, 60.8880236}, {39.5743435, 60.8887027},
                     {39.5702105, 60.8899383}, {39.5715808, 60.894876},  {39.5756376, 60.8934816},
                     {39.575804, 60.8963848},  {39.5781623, 60.8954654}, {39.5771915, 60.8972755},
                     {39.5764625, 60.8995225}, {39.5753972, 60.899806},  {39.5757272, 60.9020424},
                     {39.5756667, 60.9085222}, {39.573761, 60.9090449},  {39.5739187, 60.9098494},
                     {39.5730671, 60.9101433}, {39.5734202, 60.911451},  {39.5754811, 60.9111958},
                     {39.5749125, 60.911625},  {39.5742956, 60.9120541}, {39.5735431, 60.9123752},
                     {39.5714563, 60.9134857}, {39.5693639, 60.9155454}, {39.5686132, 60.9165059},
                     {39.5681947, 60.9168706}, {39.566623, 60.9191666},  {39.565593, 60.9203736},
                     {39.5648849, 60.9209153}, {39.5635974, 60.9213983}, {39.5624923, 60.9220313},
                     {39.5616555, 60.9226857}, {39.5585468, 60.9220115}, {39.5584681, 60.9214718},
                     {39.557726, 60.9215394},  {39.557773, 60.9236148},  {39.5559214, 60.9238989},
                     {39.5558128, 60.9234483}, {39.5548729, 60.9236425}, {39.5550671, 60.9241629},
                     {39.5556807, 60.9241862}, {39.5553234, 60.9255455}, {39.5520851, 60.926314},
                     {39.5523514, 60.9275486}, {39.5551958, 60.9271128}, {39.5554258, 60.9285653},
                     {39.5578103, 60.9285412}, {39.5581855, 60.9253456}, {39.5581065, 60.9247773},
                     {39.5581492, 60.9242442}, {39.5582759, 60.9239838}, {39.5585549, 60.9236781},
                     {39.5592254, 60.9234099}, {39.5601642, 60.9232007}, {39.5612425, 60.9231255},
                     {39.5618486, 60.9228252}, {39.5627015, 60.9221813}, {39.563694, 60.9215806},
                     {39.5649922, 60.9211138}, {39.565786, 60.9204969},  {39.5668375, 60.9192899},
                     {39.5683503, 60.9170369}, {39.5688492, 60.9166025}, {39.5695037, 60.9156851},
                     {39.5699787, 60.915234},  {39.5716011, 60.9136466}, {39.5736557, 60.9125361},
                     {39.5744404, 60.9121829}, {39.575111, 60.9116786},  {39.5756098, 60.9112709},
                     {39.5763403, 60.9116227}, {39.5775238, 60.9108459}, {39.5785224, 60.9087748},
                     {39.5798354, 60.9086454}, {39.5798539, 60.9028942}, {39.5837002, 60.9017662},
                     {39.5841002, 60.9034228}, {39.5880699, 60.9034358}, {39.59398, 60.9018506},
                     {39.59533, 60.9044951},   {39.5967909, 60.9043656}, {39.5960327, 60.9024609},
                     {39.5987153, 60.9017024}, {39.5946606, 60.8875289}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(areaPart1);
  pp.Add(areaPart2);
  pp.Add(point);

  std::vector<feature::FeatureBuilder> r{point};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {{{point.GetMostGenericOsmId(), areaPart1.GetMostGenericOsmId()},
                           2 /* cluster size */}}),
       ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, VoronezhDuplicatingCityFeatureTest)
{
  DisablerIdInc _;
  auto const point = MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}},
                                    OsmElement::EntityType::Node, {{39.2005858, 60.53736258}});

  auto const areaPart1 =
      MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}}, OsmElement::EntityType::Relation,
                    {{39.074534, 60.4989445},  {39.0679785, 60.4905635}, {39.0675323, 60.4899397},
                     {39.0636533, 60.4853405}, {39.0590853, 60.4812033}, {39.0551326, 60.4775753},
                     {39.0504648, 60.4742041}, {39.0467881, 60.4719245}, {39.0429923, 60.4697919},
                     {39.0398945, 60.4691261}, {39.0384817, 60.468709},  {39.0384817, 60.468709},
                     {39.0364008, 60.4680945}, {39.0337705, 60.4669019}, {39.0315385, 60.4659714},
                     {39.0284701, 60.4644107}, {39.0259522, 60.462626},  {39.0232518, 60.4597917},
                     {39.0208024, 60.4564464}, {39.0199627, 60.4552918}, {39.0176608, 60.4518437},
                     {39.0132338, 60.4469233}, {39.0132338, 60.4469233}, {39.0292226, 60.4432002},
                     {39.0309324, 60.4425288}, {39.0309324, 60.4425288}, {39.0307145, 60.4421027},
                     {39.0300749, 60.4406326}, {39.0296959, 60.4397554}, {39.0290986, 60.4378256},
                     {39.0285766, 60.4348871}, {39.0284563, 60.434014},  {39.0285916, 60.4322739},
                     {39.0285328, 60.4311426}, {39.0278766, 60.4288425}, {39.0268417, 60.4246525},
                     {39.0275896, 60.4212829}, {39.0276968, 60.4203925}, {39.0276303, 60.418198},
                     {39.028197, 60.4159742},  {39.028849, 60.4141625},  {39.0310687, 60.4118203},
                     {39.031518, 60.4112606},  {39.0319937, 60.4107157}, {39.0337694, 60.4076787},
                     {39.0346303, 60.4057034}, {39.0355074, 60.4050395}, {39.0361619, 60.4042455},
                     {39.0368269, 60.4016191}, {39.0385044, 60.3959187}, {39.0418776, 60.3905149},
                     {39.0463729, 60.3842885}, {39.0532441, 60.3777555}, {39.0592906, 60.3701493},
                     {39.0615436, 60.3664157}, {39.0626165, 60.3652248}, {39.0641614, 60.3638701},
                     {39.0668932, 60.3624217}, {39.0680353, 60.3618357}, {39.0680353, 60.3618357},
                     {39.0721372, 60.359349},  {39.0721372, 60.359349},  {39.0740941, 60.3581627},
                     {39.0749359, 60.359281},  {39.079018, 60.3562537},  {39.0794019, 60.354685},
                     {39.0794019, 60.354685},  {39.0805906, 60.3498271}, {39.0821251, 60.3500496},
                     {39.0839445, 60.3532185}, {39.0843611, 60.3530262}, {39.0843611, 60.3530262},
                     {39.0845581, 60.3529379}, {39.0869124, 60.3489466}, {39.0885632, 60.3467085},
                     {39.0933362, 60.3492831}, {39.0947304, 60.3503509}, {39.0997245, 60.3567334},
                     {39.0997245, 60.3567334}, {39.1032912, 60.357082},  {39.1059382, 60.3573342},
                     {39.1101709, 60.3583243}, {39.1144932, 60.3594472}, {39.1157532, 60.3596367},
                     {39.117361, 60.359902},   {39.1184208, 60.3600138}, {39.1203173, 60.3580744},
                     {39.1219902, 60.3583593}, {39.1262941, 60.3575794}, {39.1262941, 60.3575794},
                     {39.1237412, 60.3549011}, {39.1227098, 60.3542045}, {39.1203452, 60.3525582},
                     {39.1197664, 60.3521273}, {39.1188233, 60.3508459}, {39.1183308, 60.3498493},
                     {39.1182006, 60.3490173}, {39.11826, 60.346713},    {39.117875, 60.3461498},
                     {39.1164904, 60.3460998}, {39.115364, 60.3458699},  {39.114078, 60.3446772},
                     {39.1139158, 60.3441032}, {39.1139158, 60.3441032}, {39.113871, 60.3435707},
                     {39.1142252, 60.3427219}, {39.1148919, 60.3418121}, {39.115958, 60.3400625},
                     {39.1160004, 60.3384066}, {39.1154308, 60.3368106}, {39.1128315, 60.3362528},
                     {39.1110461, 60.3364721}, {39.1096837, 60.3373646}, {39.109073, 60.3384296},
                     {39.108243, 60.3394476},  {39.10663, 60.3402305},   {39.1040836, 60.3406151},
                     {39.1030062, 60.3405022}, {39.1023422, 60.3398382}, {39.1020666, 60.3384852},
                     {39.10139, 60.3368441},   {39.1005757, 60.3357541}, {39.0982204, 60.3338497},
                     {39.0965666, 60.3327347}, {39.0953389, 60.33172},   {39.0938856, 60.3300913},
                     {39.093397, 60.329089},   {39.0934471, 60.3276858}, {39.093635, 60.3258943},
                     {39.0936225, 60.3243159}, {39.0930337, 60.3228499}, {39.0918936, 60.3218728},
                     {39.0902148, 60.3212088}, {39.0878606, 60.3212463}, {39.085471, 60.3214255},
                     {39.0849333, 60.3169451}, {39.0863073, 60.311688},  {39.0863073, 60.311688},
                     {39.0888537, 60.3101306}, {39.0908582, 60.3083866}, {39.0912266, 60.3081377},
                     {39.0927424, 60.3071137}, {39.0940354, 60.3068731}, {39.0961983, 60.3084753},
                     {39.0982247, 60.3107693}, {39.0986835, 60.3144396}, {39.099438, 60.317613},
                     {39.1006758, 60.318989},  {39.1011563, 60.3170258}, {39.1030494, 60.3175751},
                     {39.1068643, 60.3174692}, {39.1132543, 60.3134163}, {39.11396, 60.306935},
                     {39.1153125, 60.3049514}, {39.1202718, 60.302697},  {39.1254115, 60.3023364},
                     {39.1287478, 60.3016151}, {39.1339579, 60.3020129}, {39.1351185, 60.3001271},
                     {39.137206, 60.2984176},  {39.1378011, 60.2973997}, {39.1392295, 60.2963042},
                     {39.1429381, 60.2945454}, {39.146035, 60.2933219},  {39.167594, 60.2845201},
                     {39.1673725, 60.2838703}, {39.2077052, 60.268394},  {39.2077052, 60.268394},
                     {39.2087758, 60.268088},  {39.209828, 60.2686863},  {39.2236482, 60.2571172},
                     {39.2246857, 60.2559231}, {39.2273088, 60.2556491}, {39.230379, 60.2546161},
                     {39.2350893, 60.260244},  {39.2376637, 60.2656999}, {39.2376637, 60.2656999},
                     {39.2392797, 60.2708269}, {39.240442, 60.2755679},  {39.2420937, 60.2758737},
                     {39.2417878, 60.2846827}, {39.2408914, 60.3009887}, {39.2406621, 60.3093235},
                     {39.2408531, 60.3135674}, {39.2415031, 60.3198759}, {39.2424281, 60.3197796},
                     {39.2539484, 60.3180343}, {39.2541584, 60.3180025}, {39.2675782, 60.3160143},
                     {39.2740397, 60.3150203}, {39.2740397, 60.3150203}, {39.2749734, 60.3419983},
                     {39.275752, 60.3424899},  {39.2708812, 60.3557508}, {39.2812542, 60.3593117},
                     {39.283223, 60.3540214},  {39.2945803, 60.3554009}, {39.2962277, 60.3554009},
                     {39.2972188, 60.3543964}, {39.2975938, 60.3535259}, {39.2976512, 60.3522484},
                     {39.3000274, 60.3459835}, {39.305464, 60.3469016},  {39.2985469, 60.3647129},
                     {39.293506, 60.3632006},  {39.2960938, 60.3559099}, {39.2946503, 60.3558435},
                     {39.283886, 60.3545988},  {39.2765715, 60.3755792}, {39.2779886, 60.3762161},
                     {39.2773621, 60.3779231}, {39.2785723, 60.3784636}, {39.2800477, 60.3776858},
                     {39.2813772, 60.3772282}, {39.283943, 60.3769314},  {39.2902157, 60.3762002},
                     {39.2906903, 60.3828151}, {39.291023, 60.3891575},  {39.2929219, 60.3919373},
                     {39.293979, 60.3912521},  {39.2956429, 60.3895686}, {39.2978941, 60.3881787},
                     {39.2993035, 60.3875524}, {39.300987, 60.3875915},  {39.3010653, 60.3890793},
                     {39.3005368, 60.3940123}, {39.2997538, 60.4000024}, {39.3040682, 60.4014775},
                     {39.3127663, 60.3925882}, {39.3282948, 60.3777679}, {39.331231, 60.3806455},
                     {39.3283731, 60.3861266}, {39.3268071, 60.3881232}, {39.328345, 60.3921937},
                     {39.327458, 60.3966287},  {39.3267239, 60.398831},  {39.3258674, 60.3998709},
                     {39.3256428, 60.4019989}, {39.3260735, 60.4033692}, {39.3262497, 60.4039956},
                     {39.3270131, 60.4051114}, {39.3285987, 60.4065991}, {39.3286378, 60.4071474},
                     {39.3281187, 60.4088279}, {39.3254568, 60.4120033}, {39.3247624, 60.4156997},
                     {39.3259345, 60.4175611}, {39.3287975, 60.4199101}, {39.3288143, 60.4212285},
                     {39.3271259, 60.4209349}, {39.3267177, 60.4221369}, {39.3268946, 60.4354818},
                     {39.3268946, 60.4354818}, {39.3234455, 60.4356568}, {39.3227292, 60.4283031},
                     {39.3170582, 60.428253},  {39.3152786, 60.4282374}, {39.3152786, 60.4282374},
                     {39.3130893, 60.4282181}, {39.3078204, 60.4522924}, {39.3003639, 60.4633539},
                     {39.3015697, 60.4839487}, {39.3017753, 60.4867081}, {39.3024147, 60.4954957},
                     {39.3036255, 60.4954311}, {39.3042343, 60.5008715}, {39.3116875, 60.4983026},
                     {39.3133615, 60.4980633}, {39.3157246, 60.500738},  {39.3154218, 60.5017763},
                     {39.3143403, 60.5016609}, {39.3126721, 60.5019185}, {39.3121571, 60.5022511},
                     {39.311577, 60.5124536},  {39.311573, 60.5127076},  {39.3115653, 60.5129593},
                     {39.3115349, 60.5133153}, {39.3090408, 60.5151322}, {39.3089062, 60.5166257},
                     {39.3085829, 60.51721},   {39.307968, 60.5174115},  {39.3064283, 60.5172574},
                     {39.3049834, 60.518412},  {39.3041794, 60.5195063}, {39.3037477, 60.5209847},
                     {39.3035394, 60.5235956}, {39.3032838, 60.530016},  {39.3027223, 60.5335122},
                     {39.3034859, 60.5341401}, {39.3035297, 60.5341239}, {39.3034808, 60.5349069},
                     {39.3024286, 60.5353963}, {39.3006445, 60.548993},  {39.3006445, 60.548993},
                     {39.3008994, 60.5556406}, {39.3009988, 60.5585426}, {39.3013448, 60.5614449},
                     {39.3021529, 60.562164},  {39.3021529, 60.562164},  {39.3026498, 60.562606},
                     {39.3044529, 60.5638511}, {39.3059691, 60.5646017}, {39.3066746, 60.5647744},
                     {39.306911, 60.5648044},  {39.3069222, 60.5651797}, {39.3066746, 60.5652247},
                     {39.3059991, 60.5655024}, {39.3026216, 60.5676791}, {39.3019761, 60.5687298},
                     {39.3021003, 60.5700593}, {39.3163074, 60.5709238}, {39.3194146, 60.5646444},
                     {39.3211107, 60.5614395}, {39.3212964, 60.5610886}, {39.3266931, 60.5640397},
                     {39.330835, 60.5638531},  {39.3328094, 60.5641037}, {39.3345579, 60.5646188},
                     {39.3345579, 60.5646188}, {39.3317416, 60.5677395}, {39.3326645, 60.5685767},
                     {39.3330356, 60.5727345}, {39.3309367, 60.5751748}, {39.3305788, 60.5760347},
                     {39.3297437, 60.5768636}, {39.3297437, 60.5818681}, {39.3298578, 60.5832858},
                     {39.3306755, 60.585368},  {39.3316085, 60.5858757}, {39.3340388, 60.588322},
                     {39.3396931, 60.5912002}, {39.3385995, 60.5940304}, {39.3467417, 60.5983273},
                     {39.3473938, 60.6031924}, {39.3514231, 60.6031424}, {39.3545997, 60.6097464},
                     {39.3603577, 60.60808},   {39.3648582, 60.6060818}, {39.3663164, 60.6030754},
                     {39.3668564, 60.599907},  {39.3661723, 60.5945965}, {39.3661723, 60.5945965},
                     {39.3674145, 60.5950105}, {39.3700248, 60.5958386}, {39.3709249, 60.5978728},
                     {39.3718395, 60.5984406}, {39.372059, 60.6005552},  {39.3726891, 60.6009332},
                     {39.3730851, 60.6016893}, {39.372311, 60.6019773},  {39.372149, 60.6028053},
                     {39.372383, 60.6036336},  {39.371843, 60.6046596},  {39.3729591, 60.6054336},
                     {39.3727611, 60.6060818}, {39.371519, 60.6061357},  {39.3709609, 60.6059017},
                     {39.3703308, 60.6063518}, {39.3697548, 60.607936},  {39.3709789, 60.6084221},
                     {39.3718468, 60.6088894}, {39.3678424, 60.6174459}, {39.367375, 60.6191103},
                     {39.3688136, 60.6195598}, {39.3688136, 60.6195598}, {39.3753141, 60.6213985},
                     {39.3858234, 60.6248484}, {39.391502, 60.6266435},  {39.391502, 60.6266435},
                     {39.3963226, 60.6281673}, {39.4001924, 60.6293928}, {39.4017524, 60.6294092},
                     {39.4027043, 60.6300776}, {39.4044894, 60.6307354}, {39.417116, 60.6349006},
                     {39.4192352, 60.6292126}, {39.426212, 60.6316035},  {39.4250706, 60.6344354},
                     {39.4318821, 60.6372139}, {39.4345433, 60.639202},  {39.439223, 60.6413125},
                     {39.4464108, 60.6408231}, {39.4481543, 60.6402113}, {39.4575138, 60.6439735},
                     {39.4582785, 60.6446159}, {39.4582785, 60.6446159}, {39.4493885, 60.6579124},
                     {39.4493885, 60.6579124}, {39.4474814, 60.6607045}, {39.4478484, 60.6621725},
                     {39.4369826, 60.6771237}, {39.4366352, 60.6810984}, {39.4366352, 60.6810984},
                     {39.4364313, 60.6822654}, {39.4355144, 60.682907},  {39.4348296, 60.6834951},
                     {39.4342526, 60.6840774}, {39.4287535, 60.6857176}, {39.4253747, 60.685791},
                     {39.4243165, 60.687029},  {39.4211957, 60.6880738}, {39.4206681, 60.689036},
                     {39.4168665, 60.688372},  {39.4156096, 60.6888689}, {39.4158277, 60.691229},
                     {39.4163751, 60.6918299}, {39.416087, 60.6926411},  {39.4182005, 60.6929819},
                     {39.4195288, 60.693217},  {39.4239747, 60.6933205}, {39.4263458, 60.6931226},
                     {39.4263458, 60.6931226}, {39.4263196, 60.6963038}, {39.4297432, 60.6960238},
                     {39.4310689, 60.6961463}, {39.4310689, 60.6961463}, {39.4423719, 60.6985356},
                     {39.4452471, 60.7137373}, {39.4465565, 60.7244651}, {39.4465565, 60.7244651},
                     {39.4078092, 60.7304534}, {39.4061858, 60.725761},  {39.4036409, 60.7265253},
                     {39.404611, 60.7305046},  {39.402436, 60.7308777},  {39.4008629, 60.7311816},
                     {39.3984821, 60.7315881}, {39.3589332, 60.7383393}, {39.3589332, 60.7383393},
                     {39.3590823, 60.7383665}, {39.3591736, 60.7384484}, {39.3592001, 60.738564},
                     {39.3589103, 60.7387503}, {39.3586863, 60.7390682}, {39.3585727, 60.7391061},
                     {39.3583926, 60.7389965}, {39.3584265, 60.7386313}, {39.3582743, 60.738479},
                     {39.3581999, 60.7384795}, {39.3576931, 60.7388254}, {39.3575104, 60.7390063},
                     {39.357512, 60.7390416},  {39.357683, 60.7392339},  {39.3577664, 60.7397321},
                     {39.3579152, 60.7399305}, {39.3581865, 60.7400766}, {39.35851, 60.7400844},
                     {39.3591083, 60.7403941}, {39.3594898, 60.7403544}, {39.3595581, 60.7401607},
                     {39.3595017, 60.7399075}, {39.3595467, 60.7395231}, {39.3600493, 60.739189},
                     {39.3612026, 60.739237},  {39.3618422, 60.7399147}, {39.3618688, 60.7404685},
                     {39.3617072, 60.7411736}, {39.3614372, 60.7418048}, {39.3614873, 60.7426897},
                     {39.360987, 60.7430191},  {39.3608161, 60.7430313}, {39.3605729, 60.7427684},
                     {39.3602726, 60.7427943}, {39.3601035, 60.7428678}, {39.3602499, 60.7436732},
                     {39.3603207, 60.744376},  {39.3605352, 60.7450636}, {39.360415, 60.7454904},
                     {39.3602973, 60.7464665}, {39.3601252, 60.746677},  {39.3597129, 60.7469782},
                     {39.3597078, 60.747788},  {39.3594709, 60.7479558}, {39.359187, 60.7478522},
                     {39.3590487, 60.7479558}, {39.3590167, 60.7484643}, {39.3590462, 60.7489904},
                     {39.3591515, 60.7491202}, {39.3595968, 60.7493162}, {39.3596017, 60.7495212},
                     {39.3595771, 60.7497335}, {39.359103, 60.7501013},  {39.3588142, 60.750595},
                     {39.3585327, 60.7508395}, {39.3584857, 60.7510075}, {39.3585154, 60.751158},
                     {39.3588339, 60.751395},  {39.3594056, 60.7515127}, {39.3594675, 60.7516912},
                     {39.3594918, 60.7521092}, {39.3596232, 60.7522943}, {39.3598663, 60.7524568},
                     {39.3600515, 60.7527409}, {39.3600939, 60.7529642}, {39.360255, 60.7530363},
                     {39.3604599, 60.752861},  {39.3606222, 60.7526967}, {39.3607666, 60.7525063},
                     {39.3608769, 60.7524583}, {39.3611002, 60.7524836}, {39.361298, 60.752618},
                     {39.3613644, 60.7527664}, {39.3613644, 60.7529939}, {39.3612753, 60.7530971},
                     {39.361209, 60.7532807},  {39.3611484, 60.7536571}, {39.3609291, 60.7539648},
                     {39.3609334, 60.7541034}, {39.3611199, 60.7544877}, {39.361527, 60.7548156},
                     {39.3616443, 60.7549966}, {39.3615708, 60.7552467}, {39.3616824, 60.7553457},
                     {39.3620837, 60.7555035}, {39.3622471, 60.7556099}, {39.3625617, 60.7557487},
                     {39.3626892, 60.7559754}, {39.3627189, 60.75611},   {39.3627917, 60.7562078},
                     {39.3629583, 60.7562843}, {39.3631912, 60.7562073}, {39.3634253, 60.756148},
                     {39.3635475, 60.7560834}, {39.3636306, 60.7557562}, {39.3638442, 60.7556985},
                     {39.3641411, 60.7556747}, {39.3641971, 60.7555662}, {39.3641123, 60.7552829},
                     {39.3642309, 60.7551659}, {39.3644312, 60.7551862}, {39.3646584, 60.7551405},
                     {39.364955, 60.7551269},  {39.3651087, 60.7550215}, {39.3652804, 60.7546539},
                     {39.3654883, 60.7545576}, {39.3656148, 60.7546931}, {39.3655636, 60.7552082},
                     {39.3654009, 60.7554462}, {39.3653316, 60.7555578}, {39.3653768, 60.7556572},
                     {39.3658468, 60.7557596}, {39.3661661, 60.7557627}, {39.3665246, 60.7559344},
                     {39.3666843, 60.7560999}, {39.3666791, 60.7562304}, {39.3666451, 60.7563279},
                     {39.3665047, 60.7563868}, {39.3664231, 60.7566337}, {39.3659089, 60.7573018},
                     {39.3659089, 60.7574899}, {39.3662228, 60.7579352}, {39.3666061, 60.75793},
                     {39.3669604, 60.7582042}, {39.3671051, 60.7584563}, {39.3670592, 60.75871},
                     {39.3669314, 60.7588599}, {39.3669757, 60.759037},  {39.3671545, 60.7594066},
                     {39.367301, 60.7594304},  {39.3675156, 60.7593623}, {39.3677659, 60.7594525},
                     {39.3677608, 60.7596483}, {39.3676127, 60.7598629}, {39.367502, 60.7600384},
                     {39.3675377, 60.7601797}, {39.3676144, 60.7601984}, {39.3678517, 60.7600971},
                     {39.3681022, 60.7601267}, {39.3682646, 60.7602982}, {39.3682977, 60.7605425},
                     {39.3681734, 60.7606392}, {39.3679493, 60.7605953}, {39.3678458, 60.760604},
                     {39.367731, 60.7606726},  {39.3676901, 60.7607977}, {39.367761, 60.760958},
                     {39.3679113, 60.7612194}, {39.3679292, 60.7612697}, {39.3680043, 60.7615166},
                     {39.3679056, 60.7616138}, {39.3677666, 60.7617723}, {39.3675767, 60.7618591},
                     {39.3672453, 60.7617847}, {39.3668742, 60.7615829}, {39.3666776, 60.7614305},
                     {39.3665367, 60.7611932}, {39.3663385, 60.7610658}, {39.366217, 60.7611011},
                     {39.3659725, 60.7612523}, {39.3657724, 60.7614251}, {39.3656002, 60.7619025},
                     {39.3654932, 60.762266},  {39.3652139, 60.7627849}, {39.3645991, 60.7632498},
                     {39.3643306, 60.7635255}, {39.3640787, 60.763905},  {39.3640609, 60.7641188},
                     {39.3638915, 60.7643176}, {39.3638436, 60.7646903}, {39.3638499, 60.7649199},
                     {39.3639038, 60.7650786}, {39.3638699, 60.7654253}, {39.3637104, 60.7658171},
                     {39.3637554, 60.7662578}, {39.3636542, 60.7665613}, {39.3637314, 60.7667334},
                     {39.3639266, 60.7667919}, {39.3640171, 60.7666021}, {39.3640845, 60.766582},
                     {39.3642229, 60.7665204}, {39.3644855, 60.7666027}, {39.3645991, 60.7669586},
                     {39.3645635, 60.7670795}, {39.3643932, 60.7671681}, {39.3641005, 60.7674325},
                     {39.36412, 60.7676045},   {39.3643063, 60.7676791}, {39.3645245, 60.7676603},
                     {39.3648643, 60.767808},  {39.3653001, 60.7681175}, {39.3652983, 60.7684198},
                     {39.3651453, 60.7686955}, {39.3652247, 60.7689479}, {39.3652962, 60.7690314},
                     {39.3653566, 60.7691803}, {39.3657062, 60.7697114}, {39.366399, 60.7706363},
                     {39.3669171, 60.771202},  {39.3671205, 60.7714723}, {39.3674637, 60.7717233},
                     {39.3681361, 60.7727795}, {39.3686628, 60.7732749}, {39.3693674, 60.773468},
                     {39.3698564, 60.7741393}, {39.3703943, 60.7744495}, {39.3712066, 60.7755462},
                     {39.3714814, 60.7757724}, {39.3718486, 60.7770151}, {39.3725285, 60.7774151},
                     {39.3734269, 60.7775193}, {39.3739814, 60.7775128}, {39.3745876, 60.7773266},
                     {39.3751649, 60.7774156}, {39.3757615, 60.7780349}, {39.3761322, 60.7781706},
                     {39.3763628, 60.7779288}, {39.3763387, 60.7776069}, {39.3759939, 60.7771002},
                     {39.3761766, 60.7766989}, {39.376543, 60.7765466},  {39.3769483, 60.7765628},
                     {39.3775482, 60.776887},  {39.378228, 60.7770232},  {39.3788462, 60.7774124},
                     {39.3808857, 60.7794285}, {39.3826802, 60.7807095}, {39.3835367, 60.7809909},
                     {39.3841283, 60.7816774}, {39.3841409, 60.7820834}, {39.3840182, 60.7827732},
                     {39.3833732, 60.7832923}, {39.3833767, 60.7848715}, {39.3823762, 60.7862636},
                     {39.3818685, 60.7868076}, {39.3809478, 60.787058},  {39.3804323, 60.7871167},
                     {39.3804106, 60.7874567}, {39.3806046, 60.7876639}, {39.3808454, 60.7881196},
                     {39.3811547, 60.7885106}, {39.3827282, 60.7894831}, {39.3840971, 60.7906266},
                     {39.3843981, 60.7918802}, {39.3840601, 60.7930658}, {39.3833189, 60.7938637},
                     {39.3832662, 60.7947394}, {39.3834263, 60.7956248}, {39.3836624, 60.7967835},
                     {39.384434, 60.7993788},  {39.385291, 60.8005561},  {39.3860103, 60.8009802},
                     {39.3862, 60.8034728},    {39.3865338, 60.8048686}, {39.3864933, 60.8057589},
                     {39.3868585, 60.8065811}, {39.387502, 60.8079652},  {39.387502, 60.8079652},
                     {39.3870434, 60.8086982}, {39.3867144, 60.8090594}, {39.3866034, 60.8093016},
                     {39.3865985, 60.8097296}, {39.3867394, 60.8101215}, {39.3869957, 60.8104504},
                     {39.3870384, 60.8108097}, {39.3869754, 60.8111514}, {39.3867394, 60.8115229},
                     {39.3861729, 60.8121043}, {39.3851303, 60.8127861}, {39.3846981, 60.8130065},
                     {39.3844476, 60.8130804}, {39.3841317, 60.8130065}, {39.3837575, 60.8124401},
                     {39.3835588, 60.8122484}, {39.3832963, 60.8121637}, {39.3829126, 60.8123124},
                     {39.3825762, 60.8127466}, {39.3824223, 60.8132898}, {39.3824692, 60.8136355},
                     {39.3821593, 60.8143721}, {39.3818447, 60.8150883}, {39.3816172, 60.815376},
                     {39.3812498, 60.8156576}, {39.3809629, 60.8159639}, {39.3806181, 60.8164071},
                     {39.3806739, 60.8169629}, {39.3808944, 60.8177307}, {39.3814753, 60.8193524},
                     {39.38083, 60.8205586},   {39.3807012, 60.8210522}, {39.3807783, 60.8213758},
                     {39.3824248, 60.82136},   {39.3830183, 60.8222001}, {39.3830747, 60.8244322},
                     {39.3824789, 60.8253168}, {39.3815131, 60.8258504}, {39.3798251, 60.8262194},
                     {39.3797678, 60.8268425}, {39.3801445, 60.8276581}, {39.3799871, 60.8280527},
                     {39.379748, 60.8284423},  {39.3800511, 60.8290437}, {39.380368, 60.8291926},
                     {39.3813391, 60.8294595}, {39.3816013, 60.8295727}, {39.3816809, 60.8298718},
                     {39.3814362, 60.8302966}, {39.3812645, 60.8306791}, {39.3812541, 60.8310957},
                     {39.3812949, 60.8313723}, {39.3814327, 60.8316467}, {39.3816684, 60.831792},
                     {39.3822807, 60.8320161}, {39.3827056, 60.8322488}, {39.3828635, 60.8322914},
                     {39.3831305, 60.8321476}, {39.3833097, 60.8320007}, {39.3838486, 60.8321324},
                     {39.3842229, 60.8320212}, {39.3843725, 60.8319997}, {39.3845821, 60.8321574},
                     {39.384562, 60.8324584},  {39.3845906, 60.8325979}, {39.3847337, 60.8326635},
                     {39.385011, 60.8325855},  {39.3853766, 60.8326382}, {39.385551, 60.8328485},
                     {39.3856408, 60.8331878}, {39.3855226, 60.833594},  {39.3855011, 60.8338457},
                     {39.3855795, 60.8341481}, {39.385578, 60.8349811},  {39.3853598, 60.8356313},
                     {39.3849157, 60.8361986}, {39.3845801, 60.8364215}, {39.3844606, 60.8366083},
                     {39.3843759, 60.8371015}, {39.3844225, 60.8375956}, {39.3846578, 60.8380749},
                     {39.384792, 60.8381866},  {39.38477, 60.8383973},   {39.3845393, 60.8385249},
                     {39.3843197, 60.8385492}, {39.3839706, 60.8384339}, {39.3838097, 60.8384004},
                     {39.3834946, 60.8385605}, {39.383468, 60.8388494},  {39.3834711, 60.8393577},
                     {39.3833329, 60.8395251}, {39.3830942, 60.8395518}, {39.3826302, 60.8395384},
                     {39.3819684, 60.8394877}, {39.3818684, 60.8391899}, {39.3817406, 60.8389632},
                     {39.381458, 60.8388598},  {39.3812456, 60.8389812}, {39.3813186, 60.8397127},
                     {39.3814742, 60.8403711}, {39.3816794, 60.8409309}, {39.3823271, 60.8415473},
                     {39.3830653, 60.8420778}, {39.3833168, 60.8425103}, {39.3835612, 60.8432301},
                     {39.3842663, 60.8435189}, {39.3846739, 60.8435511}, {39.3849843, 60.8437981},
                     {39.3850938, 60.8449307}, {39.3853713, 60.845611},  {39.385822, 60.8461475},
                     {39.386629, 60.8472838},  {39.387088, 60.8480411},  {39.3875296, 60.8486492},
                     {39.3877639, 60.8488458}, {39.3881147, 60.8486562}, {39.3881169, 60.8481316},
                     {39.3882105, 60.847843},  {39.3884451, 60.8477513}, {39.3886332, 60.8479778},
                     {39.3889334, 60.8486955}, {39.3890308, 60.8495479}, {39.3891372, 60.850439},
                     {39.389048, 60.8513337},  {39.3882467, 60.8526276}, {39.3873171, 60.8538228},
                     {39.3873981, 60.8540237}, {39.3878632, 60.8542075}, {39.3881126, 60.854304},
                     {39.3882951, 60.8544832}, {39.3883755, 60.8549049}, {39.388322, 60.8553333},
                     {39.3878685, 60.8562486}, {39.3876164, 60.85671},   {39.3873583, 60.8572544},
                     {39.3870869, 60.8582247}, {39.3868064, 60.8589522}, {39.3863113, 60.8595507},
                     {39.3861009, 60.8596524}, {39.3858507, 60.8596066}, {39.3857465, 60.8593609},
                     {39.3857549, 60.858888},  {39.3856396, 60.8585902}, {39.385232, 60.8585463},
                     {39.3850596, 60.8585983}, {39.3851027, 60.8588635}, {39.3847504, 60.8590424},
                     {39.3841551, 60.8592563}, {39.3839161, 60.8591185}, {39.3834614, 60.8590347},
                     {39.3829781, 60.8590745}, {39.3826127, 60.8591919}, {39.3824131, 60.8594582},
                     {39.3821259, 60.8598699}, {39.3817799, 60.8604711}, {39.3817166, 60.8609792},
                     {39.3815385, 60.8614334}, {39.3812343, 60.8618045}, {39.3805543, 60.8625275},
                     {39.3802341, 60.8627124}, {39.3798766, 60.8625683}, {39.3797786, 60.862334},
                     {39.3797526, 60.8621373}, {39.3794166, 60.8626059}, {39.3794138, 60.8630614},
                     {39.3794765, 60.8634835}, {39.3787556, 60.86397},   {39.3781866, 60.8645389},
                     {39.3781866, 60.8645389}, {39.3780521, 60.8648428}, {39.3780551, 60.8654606},
                     {39.3782602, 60.8659295}, {39.3792151, 60.8675964}, {39.3796791, 60.8687858},
                     {39.379858, 60.8689957},  {39.3799276, 60.869532},  {39.3804858, 60.8697163},
                     {39.3803013, 60.8702216}, {39.3803013, 60.8702216}, {39.3794977, 60.8701099},
                     {39.3790968, 60.8701244}, {39.3786931, 60.8701306}, {39.3784357, 60.8697873},
                     {39.3779207, 60.8696156}, {39.3776632, 60.8697748}, {39.3776632, 60.8697748},
                     {39.3775627, 60.8707246}, {39.3760324, 60.8721779}, {39.3747449, 60.8728646},
                     {39.3736018, 60.8734027}, {39.3721808, 60.8729211}, {39.3713117, 60.8734654},
                     {39.3706666, 60.8739563}, {39.3698903, 60.8744567}, {39.3697467, 60.8746338},
                     {39.3697467, 60.8746338}, {39.3651032, 60.8741594}, {39.3623772, 60.8743899},
                     {39.3619106, 60.8750592}, {39.35963, 60.8784419},   {39.3577467, 60.8771992},
                     {39.3577467, 60.8771992}, {39.3584476, 60.876563},  {39.3596633, 60.8750168},
                     {39.3607623, 60.8722916}, {39.3612547, 60.8698211}, {39.3610701, 60.8678383},
                     {39.3604116, 60.8663375}, {39.3591175, 60.8640173}, {39.3576198, 60.862279},
                     {39.3559492, 60.8612081}, {39.3533183, 60.8606785}, {39.3516485, 60.8608173},
                     {39.3495838, 60.861753},  {39.3481542, 60.8629834}, {39.3468653, 60.8634882},
                     {39.3448637, 60.8635396}, {39.3432535, 60.863444},  {39.3416705, 60.8634735},
                     {39.340865, 60.8640445},  {39.3400605, 60.8651296}, {39.3397396, 60.8666589},
                     {39.340082, 60.868477},   {39.338931, 60.869521},   {39.3380439, 60.8696681},
                     {39.3372596, 60.8694313}, {39.3367697, 60.868585},  {39.3362405, 60.8661394},
                     {39.3360555, 60.8650941}, {39.335879, 60.8637611},  {39.3355401, 60.8625104},
                     {39.335138, 60.8618518},  {39.3344714, 60.8611916}, {39.3337305, 60.860707},
                     {39.3326791, 60.8606663}, {39.3317135, 60.8609024}, {39.331335, 60.8614871},
                     {39.3314095, 60.8622361}, {39.3312192, 60.8629754}, {39.3309226, 60.8635815},
                     {39.3301472, 60.8642496}, {39.3293692, 60.8648009}, {39.3285991, 60.8650711},
                     {39.3275926, 60.8650093}, {39.325406, 60.8642403},  {39.3229466, 60.8634342},
                     {39.3210379, 60.8625649}, {39.3191178, 60.8615676}, {39.3176468, 60.8601464},
                     {39.3166931, 60.8582631}, {39.3166287, 60.8558169}, {39.3142039, 60.8504311},
                     {39.3137749, 60.8472768}, {39.3073805, 60.8409467}, {39.3023594, 60.835754},
                     {39.3013723, 60.8325568}, {39.301298, 60.8314029},  {39.3006441, 60.8269189},
                     {39.3006656, 60.8196877}, {39.3002794, 60.8166191}, {39.299464, 60.8152888},
                     {39.2985627, 60.8146237}, {39.2969105, 60.814452},  {39.294872, 60.8153747},
                     {39.2934557, 60.8160184}, {39.2919109, 60.815482},  {39.2904517, 60.8125851},
                     {39.2887137, 60.8110187}, {39.2868898, 60.8105038}, {39.2835638, 60.8105252},
                     {39.2819545, 60.8092378}, {39.2814395, 60.8082293}, {39.2814854, 60.8069483},
                     {39.2814854, 60.8069483}, {39.2816326, 60.8028434}, {39.281182, 60.7990669},
                     {39.280946, 60.7973288},  {39.28071, 60.7942388},   {39.2805383, 60.7924364},
                     {39.2792079, 60.7888315}, {39.2745731, 60.7830594}, {39.2721054, 60.779991},
                     {39.2721054, 60.779991},  {39.2715261, 60.7779377}, {39.2699544, 60.7788766},
                     {39.2691013, 60.7788979}, {39.2686684, 60.7786448}, {39.2677625, 60.7783024},
                     {39.2677979, 60.779531},  {39.2680071, 60.7797348}, {39.2674814, 60.7800407},
                     {39.2660168, 60.7815211}, {39.2649118, 60.781135},  {39.2651917, 60.780231},
                     {39.2644066, 60.7784397}, {39.2636814, 60.7778193}, {39.2627148, 60.7771125},
                     {39.2625354, 60.7773101}, {39.2622081, 60.7772995}, {39.2618863, 60.7771224},
                     {39.2606954, 60.7789033}, {39.2597564, 60.7774719}, {39.25958, 60.7771295},
                     {39.2590646, 60.7750195}, {39.2574105, 60.7747104}, {39.2567201, 60.7747829},
                     {39.2568648, 60.7756567}, {39.2567008, 60.7758306}, {39.2570049, 60.7765162},
                     {39.2566863, 60.7767093}, {39.2568505, 60.7770569}, {39.2568505, 60.7770569},
                     {39.2556808, 60.7783458}, {39.2554196, 60.7783658}, {39.2543546, 60.7778033},
                     {39.2541939, 60.7766781}, {39.2538322, 60.776477},  {39.2527472, 60.7745081},
                     {39.2498072, 60.7754807}, {39.2470979, 60.7797799}, {39.2466792, 60.7809377},
                     {39.2392047, 60.7828666}, {39.239044, 60.7826657},  {39.2496529, 60.7740659},
                     {39.2519499, 60.7731652}, {39.2527455, 60.7714035}, {39.2521772, 60.7687893},
                     {39.2510406, 60.7675958}, {39.2489947, 60.7669706}, {39.24621, 60.7684482},
                     {39.244849, 60.7702758},  {39.2453053, 60.7725699}, {39.2397881, 60.7750974},
                     {39.2327979, 60.7728243}, {39.2302974, 60.7724265}, {39.2256372, 60.774586},
                     {39.2210339, 60.7690734}, {39.2229377, 60.7688548}, {39.2250412, 60.7680861},
                     {39.2294021, 60.7652243}, {39.2268569, 60.7611643}, {39.2223259, 60.7553317},
                     {39.2186797, 60.7547686}, {39.2186797, 60.7547686}, {39.2166289, 60.7546763},
                     {39.21481, 60.7541095},   {39.2114927, 60.7501929}, {39.2010451, 60.7310453},
                     {39.1947324, 60.7186209}, {39.1940148, 60.7186303}, {39.1940148, 60.7186303},
                     {39.1929596, 60.7135347}, {39.1929596, 60.7135347}, {39.1929381, 60.7135384},
                     {39.1926754, 60.7135833}, {39.1922298, 60.7136597}, {39.1922298, 60.7136597},
                     {39.1919116, 60.713705},  {39.1888979, 60.7141327}, {39.1888979, 60.7141327},
                     {39.1880892, 60.7106502}, {39.1879727, 60.709759},  {39.187914, 60.7091062},
                     {39.1878863, 60.7087296}, {39.1883355, 60.708664},  {39.1882423, 60.7081112},
                     {39.1879348, 60.7082149}, {39.1878899, 60.7081112}, {39.1876061, 60.7080739},
                     {39.1874603, 60.7080249}, {39.1871713, 60.7079178}, {39.1866739, 60.7078659},
                     {39.1863975, 60.7080249}, {39.1859173, 60.7080835}, {39.1853897, 60.7080567},
                     {39.1849811, 60.7082149}, {39.1848118, 60.7084602}, {39.1847427, 60.7084326},
                     {39.1846667, 60.7082666}, {39.1842382, 60.7083495}, {39.1833747, 60.7085568},
                     {39.1832641, 60.7089335}, {39.1830843, 60.7089366}, {39.1829112, 60.7091836},
                     {39.1834477, 60.7117371}, {39.1807226, 60.7118014}, {39.1807226, 60.7118014},
                     {39.1804479, 60.7116133}, {39.1804479, 60.7116133}, {39.1711657, 60.6934705},
                     {39.1711657, 60.6934705}, {39.1693903, 60.6900539}, {39.1693903, 60.6900539},
                     {39.1670095, 60.6905592}, {39.1666335, 60.6892093}, {39.1653307, 60.6894434},
                     {39.1653307, 60.6894434}, {39.1621514, 60.6895132}, {39.162135, 60.6902023},
                     {39.1617133, 60.6902371}, {39.1616998, 60.6918047}, {39.1602775, 60.6918381},
                     {39.1602495, 60.6913286}, {39.1591231, 60.6912582}, {39.1590514, 60.6902413},
                     {39.1590027, 60.6895466}, {39.1581001, 60.6895481}, {39.1579375, 60.6887479},
                     {39.1578532, 60.6877115}, {39.1583431, 60.6876104}, {39.1582188, 60.6869091},
                     {39.1602567, 60.6866911}, {39.1604119, 60.6860273}, {39.1613131, 60.6860048},
                     {39.1615707, 60.6856018}, {39.1626644, 60.6855198}, {39.1636792, 60.686174},
                     {39.1636792, 60.686174},  {39.1645831, 60.6865985}, {39.1649631, 60.6877367},
                     {39.1655263, 60.6876563}, {39.1658424, 60.6889681}, {39.1686459, 60.6884462},
                     {39.166694, 60.684668},   {39.1652889, 60.6819339}, {39.1649497, 60.6810895},
                     {39.1647075, 60.6804319}, {39.1644514, 60.6795253}, {39.1641537, 60.6783486},
                     {39.164043, 60.6776702},  {39.163953, 60.6766874},  {39.1639288, 60.675964},
                     {39.1639426, 60.6752095}, {39.1638645, 60.6751932}, {39.1638645, 60.6751932},
                     {39.1636553, 60.6748951}, {39.1636553, 60.6748951}, {39.1633664, 60.6755132},
                     {39.1620407, 60.6747767}, {39.1616145, 60.6754307}, {39.1613494, 60.6757161},
                     {39.1613458, 60.6757199}, {39.1610141, 60.6761691}, {39.1610141, 60.6761691},
                     {39.1607881, 60.6764753}, {39.1607881, 60.6764753}, {39.1607335, 60.6765493},
                     {39.1603395, 60.6772572}, {39.1597249, 60.6783615}, {39.1592714, 60.6779979},
                     {39.1592714, 60.6779979}, {39.1585192, 60.6778193}, {39.1587072, 60.6771141},
                     {39.1584954, 60.6769636}, {39.153677, 60.677415},   {39.1526708, 60.6774055},
                     {39.1507262, 60.6777029}, {39.1506764, 60.6777104}, {39.1498955, 60.6777726},
                     {39.1489879, 60.677845},  {39.1459251, 60.6780892}, {39.1448019, 60.6781787},
                     {39.1447123, 60.6778187}, {39.1441157, 60.6747943}, {39.1436984, 60.6734998},
                     {39.1430578, 60.6734985}, {39.1423721, 60.6736492}, {39.141898, 60.6738049},
                     {39.1419971, 60.6740951}, {39.1419152, 60.6741379}, {39.1417029, 60.6742298},
                     {39.1415443, 60.674116},  {39.1413853, 60.6782394}, {39.1383174, 60.6771543},
                     {39.140506, 60.6743414},  {39.1403559, 60.6743203}, {39.1403188, 60.6743119},
                     {39.1399996, 60.6742392}, {39.1399055, 60.6740685}, {39.1398745, 60.6740123},
                     {39.1398244, 60.6739084}, {39.139655, 60.6735578},  {39.1391778, 60.673296},
                     {39.1391651, 60.673289},  {39.1387829, 60.6734893}, {39.1382804, 60.6733415},
                     {39.1382804, 60.6733415}, {39.1364566, 60.6730238}, {39.1364566, 60.6730238},
                     {39.1373136, 60.6676373}, {39.1367211, 60.6666879}, {39.1367863, 60.6657977},
                     {39.1367137, 60.6645684}, {39.1363525, 60.6624237}, {39.1359295, 60.6604454},
                     {39.1354017, 60.6598115}, {39.1349164, 60.6591683}, {39.1347061, 60.6589603},
                     {39.1344061, 60.658079},  {39.1343154, 60.6544093}, {39.1337902, 60.6528918},
                     {39.1332648, 60.6514345}, {39.1333174, 60.6507274}, {39.1322643, 60.6495766},
                     {39.1311812, 60.6489146}, {39.1305346, 60.6478046}, {39.1306199, 60.6476437},
                     {39.1296723, 60.6458906}, {39.1286388, 60.6442886}, {39.1275695, 60.6431144},
                     {39.1260609, 60.6413089}, {39.1237516, 60.6380907}, {39.122466, 60.6371541},
                     {39.1202441, 60.6361074}, {39.116608, 60.6347668},  {39.11479, 60.6346566},
                     {39.11479, 60.6346566},   {39.1131669, 60.6350372}, {39.1121312, 60.6307225},
                     {39.1115117, 60.6271944}, {39.110867, 60.6268382},  {39.1102702, 60.6205945},
                     {39.1096733, 60.618804},  {39.1080206, 60.6149476}, {39.1059726, 60.6114809},
                     {39.1042772, 60.6090386}, {39.1034517, 60.6078495}, {39.1020356, 60.6054971},
                     {39.0987634, 60.6035601}, {39.0974232, 60.603347},  {39.0961428, 60.6023463},
                     {39.094699, 60.6018808},  {39.093164, 60.6019453},  {39.0927901, 60.6020344},
                     {39.0927901, 60.6020344}, {39.0908621, 60.6024938}, {39.0898627, 60.6025409},
                     {39.0884213, 60.6031724}, {39.0869069, 60.6024131}, {39.0874503, 60.6036316},
                     {39.0870531, 60.603939},  {39.0839177, 60.6059448}, {39.0842168, 60.606579},
                     {39.082394, 60.6089421},  {39.0816136, 60.6089045}, {39.0816042, 60.6103149},
                     {39.0806546, 60.6121577}, {39.0808425, 60.613521},  {39.0804947, 60.6159562},
                     {39.0790932, 60.6201271}, {39.0775616, 60.622367},  {39.0746668, 60.6243017},
                     {39.0728914, 60.6250398}, {39.0702083, 60.6250341}, {39.0689044, 60.624171},
                     {39.0679128, 60.6219857}, {39.0673435, 60.6208472}, {39.0675639, 60.6144565},
                     {39.0653602, 60.6134833}, {39.0644053, 60.6125098}, {39.0634503, 60.6102143},
                     {39.0630087, 60.6073537}, {39.0630266, 60.6063403}, {39.06134, 60.6035438},
                     {39.0592917, 60.601363},  {39.0577895, 60.598861},  {39.0612667, 60.5957567},
                     {39.0649022, 60.5943114}, {39.0595021, 60.5902343}, {39.056567, 60.591372},
                     {39.0554101, 60.5864061}, {39.0546168, 60.583958},  {39.0521549, 60.5821625},
                     {39.0440392, 60.5818647}, {39.0430364, 60.5813185}, {39.0430364, 60.5813185},
                     {39.0442178, 60.5785956}, {39.0460675, 60.5728621}, {39.0493924, 60.573944},
                     {39.0516316, 60.5730794}, {39.0576664, 60.5756923}, {39.0650254, 60.5692313},
                     {39.07058, 60.56373},     {39.0713164, 60.5630871}, {39.0702443, 60.5616339},
                     {39.0737686, 60.5553721}, {39.0731672, 60.5549277}, {39.0761617, 60.5522271},
                     {39.0799856, 60.5435022}, {39.0845975, 60.5422713}, {39.0849514, 60.5405316},
                     {39.0849514, 60.5405316}, {39.0831578, 60.539268},  {39.0817256, 60.5375887},
                     {39.0817416, 60.5349443}, {39.0819822, 60.5322787}, {39.082949, 60.5265732},
                     {39.0855607, 60.5203736}, {39.0857793, 60.5197705}, {39.0858319, 60.5194978},
                     {39.0858319, 60.5194978}, {39.0839032, 60.5197573}, {39.0656917, 60.5221284},
                     {39.0634815, 60.5224153}, {39.0634138, 60.5219218}, {39.0635885, 60.5218609},
                     {39.0639711, 60.5211452}, {39.0639756, 60.5208753}, {39.0635833, 60.5198633},
                     {39.0617735, 60.5163554}, {39.0598699, 60.5127537}, {39.0594012, 60.511903},
                     {39.058947, 60.5114991},  {39.0583233, 60.5112972}, {39.0580817, 60.5111567},
                     {39.0578654, 60.5109332}, {39.0574796, 60.5102913}, {39.0573895, 60.5099669},
                     {39.0574111, 60.5093541}, {39.0573895, 60.508871},  {39.0572705, 60.5083661},
                     {39.0565315, 60.5065671}, {39.0558717, 60.5052836}, {39.0549416, 60.504029},
                     {39.0534959, 60.5024211}, {39.0514804, 60.5001536}, {39.0511669, 60.4997965},
                     {39.0496022, 60.4980337}, {39.0489208, 60.497071},  {39.0482539, 60.4972836},
                     {39.0478373, 60.4969471}, {39.0473653, 60.496974},  {39.0464962, 60.4956651},
                     {39.048701, 60.495083},   {39.0490182, 60.4951783}, {39.049436, 60.4954571},
                     {39.0499384, 60.494985},  {39.0532603, 60.4986839}, {39.0566832, 60.5031153},
                     {39.05748, 60.5039807},   {39.0584321, 60.505753},  {39.0594408, 60.5078646},
                     {39.0605908, 60.5108811}, {39.061255, 60.5122011},  {39.0623819, 60.5141428},
                     {39.063243, 60.5154205},  {39.0640309, 60.516751},  {39.0646518, 60.5176693},
                     {39.0650901, 60.5191406}, {39.0656723, 60.5212038}, {39.0658838, 60.5215053},
                     {39.0662078, 60.5216313}, {39.0829915, 60.5194067}, {39.0873385, 60.5189737},
                     {39.0832019, 60.5141536}, {39.0831376, 60.5138536}, {39.0831376, 60.5138536},
                     {39.0826737, 60.5122797}, {39.0821455, 60.5121339}, {39.0814726, 60.5113937},
                     {39.0799613, 60.5079542}, {39.0785289, 60.5025001}, {39.0785289, 60.5025001},
                     {39.074534, 60.4989445}});

  auto const areaPart2 =
      MakeFbForTest({{"name", "Voronezh"}, {"place", "city"}}, OsmElement::EntityType::Relation,
                    {{39.5946606, 60.8875289}, {39.5968517, 60.8869367}, {39.5972678, 60.8879075},
                     {39.5986103, 60.8876559}, {39.5982294, 60.8865667}, {39.6055335, 60.8844839},
                     {39.6191364, 60.8802595}, {39.6286584, 60.877039},  {39.6301079, 60.8766673},
                     {39.6313778, 60.8764702}, {39.6317262, 60.876505},  {39.6325422, 60.8765938},
                     {39.634078, 60.8770359},  {39.6347191, 60.8773924}, {39.635447, 60.8781113},
                     {39.6368783, 60.880108},  {39.6377176, 60.8808965}, {39.6390401, 60.8816509},
                     {39.6423185, 60.8824302}, {39.6456165, 60.8833201}, {39.6470101, 60.8836975},
                     {39.6476579, 60.8837482}, {39.6485349, 60.8836432}, {39.6513069, 60.8828246},
                     {39.6513069, 60.8828246}, {39.6521335, 60.8832661}, {39.6524211, 60.8836576},
                     {39.6527818, 60.8842148}, {39.6539063, 60.8844241}, {39.6551225, 60.8846202},
                     {39.6543976, 60.8849724}, {39.6493714, 60.8884477}, {39.6426274, 60.8919149},
                     {39.6414069, 60.8920628}, {39.6430342, 60.8942449}, {39.6453643, 60.8938381},
                     {39.6473183, 60.8928851}, {39.6472667, 60.8923942}, {39.6472517, 60.8916301},
                     {39.6477421, 60.8907508}, {39.6488097, 60.8908887}, {39.6493376, 60.8912966},
                     {39.6495535, 60.8919444}, {39.65005, 60.8931992},   {39.6548359, 60.8920746},
                     {39.6567973, 60.8927024}, {39.6583664, 60.8925716}, {39.6596479, 60.8914732},
                     {39.658968, 60.8908717},  {39.6589023, 60.8870805}, {39.6589523, 60.8856009},
                     {39.6587403, 60.8855838}, {39.658523, 60.886978},   {39.6581896, 60.8878542},
                     {39.6572372, 60.8880021}, {39.6563773, 60.8860512}, {39.6554342, 60.884433},
                     {39.6541187, 60.88422},   {39.6530963, 60.884057},  {39.6525504, 60.8831694},
                     {39.6518007, 60.8826616}, {39.651681, 60.8824671},  {39.651681, 60.8824671},
                     {39.6509013, 60.8826646}, {39.6491612, 60.8831207}, {39.6481088, 60.8834785},
                     {39.6474002, 60.8835556}, {39.6468108, 60.8834012}, {39.6453725, 60.8829943},
                     {39.6437508, 60.882597},  {39.6419565, 60.8821976}, {39.6401832, 60.8816778},
                     {39.6388317, 60.8811563}, {39.6376584, 60.880528},  {39.6370055, 60.8798228},
                     {39.6359197, 60.8783514}, {39.6352398, 60.8775649}, {39.6345547, 60.877022},
                     {39.6333095, 60.8765653}, {39.6322361, 60.8763473}, {39.6319032, 60.8763006},
                     {39.6319032, 60.8763006}, {39.6319195, 60.8760831}, {39.6320477, 60.8758773},
                     {39.6368601, 60.8743827}, {39.637021, 60.8744846},  {39.6379222, 60.8761046},
                     {39.6384694, 60.8766357}, {39.6380831, 60.8768772}, {39.6385445, 60.8774512},
                     {39.6390112, 60.8771132}, {39.6396979, 60.8779178}, {39.6404489, 60.8782772},
                     {39.6418972, 60.8775853}, {39.6443005, 60.8784059}, {39.6446278, 60.8776925},
                     {39.6475353, 60.8755574}, {39.6462264, 60.8736316}, {39.6450676, 60.8754233},
                     {39.6425195, 60.8745544}, {39.6398856, 60.8729022}, {39.6411302, 60.8718775},
                     {39.6405614, 60.8709118}, {39.6391775, 60.8719042}, {39.6392258, 60.8723549},
                     {39.6386357, 60.8729022}, {39.6382119, 60.8726231}, {39.6377667, 60.8730737},
                     {39.6378471, 60.8733527}, {39.6377452, 60.8735082}, {39.6367384, 60.8740927},
                     {39.6318283, 60.8755843}, {39.6314688, 60.8759545}, {39.6313685, 60.8762914},
                     {39.6313685, 60.8762914}, {39.630195, 60.8764159},  {39.5945785, 60.8871764},
                     {39.5919657, 60.8781552}, {39.5928287, 60.8769627}, {39.6005411, 60.8735968},
                     {39.6005411, 60.8735968}, {39.5976054, 60.8676474}, {39.5939809, 60.8687199},
                     {39.5943137, 60.8704582}, {39.5845174, 60.8784659}, {39.5837184, 60.8780203},
                     {39.5830939, 60.8782535}, {39.5835092, 60.8799295}, {39.5839792, 60.8802805},
                     {39.5835354, 60.8831493}, {39.5842152, 60.8842446}, {39.5833523, 60.88414},
                     {39.5821493, 60.8843753}, {39.5816001, 60.8860492}, {39.5811293, 60.8876967},
                     {39.5813124, 60.8858399}, {39.5812601, 60.88482},   {39.5800308, 60.8848462},
                     {39.5799262, 60.8872783}, {39.5796125, 60.8888735}, {39.5803448, 60.8898673},
                     {39.5797956, 60.8905213}, {39.5782003, 60.8908351}, {39.5781146, 60.8905414},
                     {39.5779781, 60.8905736}, {39.5740415, 60.8774795}, {39.5753507, 60.8771213},
                     {39.5744063, 60.8734868}, {39.576217, 60.8732588},  {39.5756113, 60.8723404},
                     {39.5754029, 60.8714806}, {39.574771, 60.870901},   {39.5729864, 60.8714415},
                     {39.5728675, 60.871084},  {39.5728557, 60.8710875}, {39.5719833, 60.8713504},
                     {39.5778618, 60.8906084}, {39.575843, 60.8911816},  {39.5753602, 60.8896041},
                     {39.5765571, 60.8892074}, {39.5762171, 60.8880236}, {39.5743435, 60.8887027},
                     {39.5702105, 60.8899383}, {39.5715808, 60.894876},  {39.5756376, 60.8934816},
                     {39.575804, 60.8963848},  {39.5781623, 60.8954654}, {39.5771915, 60.8972755},
                     {39.5764625, 60.8995225}, {39.5753972, 60.899806},  {39.5757272, 60.9020424},
                     {39.5756667, 60.9085222}, {39.573761, 60.9090449},  {39.5739187, 60.9098494},
                     {39.5730671, 60.9101433}, {39.5734202, 60.911451},  {39.5754811, 60.9111958},
                     {39.5749125, 60.911625},  {39.5742956, 60.9120541}, {39.5735431, 60.9123752},
                     {39.5714563, 60.9134857}, {39.5693639, 60.9155454}, {39.5686132, 60.9165059},
                     {39.5681947, 60.9168706}, {39.566623, 60.9191666},  {39.565593, 60.9203736},
                     {39.5648849, 60.9209153}, {39.5635974, 60.9213983}, {39.5624923, 60.9220313},
                     {39.5616555, 60.9226857}, {39.5585468, 60.9220115}, {39.5584681, 60.9214718},
                     {39.557726, 60.9215394},  {39.557773, 60.9236148},  {39.5559214, 60.9238989},
                     {39.5558128, 60.9234483}, {39.5548729, 60.9236425}, {39.5550671, 60.9241629},
                     {39.5556807, 60.9241862}, {39.5553234, 60.9255455}, {39.5520851, 60.926314},
                     {39.5523514, 60.9275486}, {39.5551958, 60.9271128}, {39.5554258, 60.9285653},
                     {39.5578103, 60.9285412}, {39.5581855, 60.9253456}, {39.5581065, 60.9247773},
                     {39.5581492, 60.9242442}, {39.5582759, 60.9239838}, {39.5585549, 60.9236781},
                     {39.5592254, 60.9234099}, {39.5601642, 60.9232007}, {39.5612425, 60.9231255},
                     {39.5618486, 60.9228252}, {39.5627015, 60.9221813}, {39.563694, 60.9215806},
                     {39.5649922, 60.9211138}, {39.565786, 60.9204969},  {39.5668375, 60.9192899},
                     {39.5683503, 60.9170369}, {39.5688492, 60.9166025}, {39.5695037, 60.9156851},
                     {39.5699787, 60.915234},  {39.5716011, 60.9136466}, {39.5736557, 60.9125361},
                     {39.5744404, 60.9121829}, {39.575111, 60.9116786},  {39.5756098, 60.9112709},
                     {39.5763403, 60.9116227}, {39.5775238, 60.9108459}, {39.5785224, 60.9087748},
                     {39.5798354, 60.9086454}, {39.5798539, 60.9028942}, {39.5837002, 60.9017662},
                     {39.5841002, 60.9034228}, {39.5880699, 60.9034358}, {39.59398, 60.9018506},
                     {39.59533, 60.9044951},   {39.5967909, 60.9043656}, {39.5960327, 60.9024609},
                     {39.5987153, 60.9017024}, {39.5946606, 60.8875289}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(areaPart1);
  pp.Add(areaPart2);
  pp.Add(point);

  std::vector<feature::FeatureBuilder> r{point};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(TestTable(*table, {{{point.GetMostGenericOsmId(), areaPart1.GetMostGenericOsmId()},
                           2 /* cluster size */}}),
       ());
}

UNIT_CLASS_TEST(TestPlaceProcessor, KuznetsovoNearbyHamletsTest)
{
  auto const point1 = MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}},
                                     OsmElement::EntityType::Node, {{39.5338039, 71.44840478}});

  auto const way1 =
      MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}}, OsmElement::EntityType::Way,
                    {{39.5300791, 71.4499322},
                     {39.5360952, 71.449952},
                     {39.5358614, 71.4481361},
                     {39.533932, 71.4479877},
                     {39.5334559, 71.4466931},
                     {39.5328246, 71.4468055},
                     {39.531898, 71.447587},
                     {39.5305723, 71.4482665},
                     {39.5300791, 71.4499322}});

  auto const point2 = MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}},
                                     OsmElement::EntityType::Node, {{39.6701222, 71.52284624}});

  auto const way2 =
      MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}}, OsmElement::EntityType::Way,
                    {{39.6670159, 71.5224511},
                     {39.6719028, 71.525375},
                     {39.6732332, 71.5231513},
                     {39.6683465, 71.5202275},
                     {39.6670159, 71.5224511}});

  auto const point3 = MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}},
                                     OsmElement::EntityType::Node, {{39.9688407, 71.45936188}});

  auto const way3 =
      MakeFbForTest({{"name", "Кузнецово"}, {"place", "hamlet"}}, OsmElement::EntityType::Way,
                    {{39.9694614, 71.4609508},
                     {39.9695483, 71.460343},
                     {39.9698434, 71.4598916},
                     {39.970373, 71.4583027},
                     {39.9703469, 71.458025},
                     {39.9701473, 71.4578426},
                     {39.969036, 71.458485},
                     {39.9685064, 71.4579208},
                     {39.968246, 71.4578946},
                     {39.967647, 71.4588411},
                     {39.9676383, 71.4589973},
                     {39.9680029, 71.4591536},
                     {39.9681505, 71.459414},
                     {39.9670826, 71.4609508},
                     {39.9690534, 71.461055},
                     {39.9694614, 71.4609508}});

  auto table = std::make_shared<generator::OsmIdToBoundariesTable>();
  generator::PlaceProcessor pp(table);
  pp.Add(point1);
  pp.Add(point2);
  pp.Add(point3);
  pp.Add(way1);
  pp.Add(way2);
  pp.Add(way3);
  std::vector<feature::FeatureBuilder> r{point1, point2, point3};
  TEST_EQUAL(pp.ProcessPlaces(), r, ());
  TEST(
      TestTable(
          *table,
          {{{point1.GetMostGenericOsmId(), way1.GetMostGenericOsmId()}, 1 /* cluster size */},
           {{point2.GetMostGenericOsmId(), way2.GetMostGenericOsmId()}, 1 /* cluster size */},
           {{point3.GetMostGenericOsmId(), way3.GetMostGenericOsmId()}, 1 /* cluster size */}}),
      ());
}
}  // namespace
